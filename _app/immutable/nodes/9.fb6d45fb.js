import{s as $e,o as Ie,n as te,e as Me}from"../chunks/scheduler.55fc80cd.js";import{S as Se,i as He,g,s as V,D as Ve,h as y,f as p,c as A,j as S,x as Y,k as _,z as d,a as F,t as q,b as se,d as P,p as re,e as ue,F as Ae,A as Ne,m as O,r as fe,n as j,u as de,v as he,o as J,w as pe,B as _e}from"../chunks/index.0e88a81e.js";import{e as me}from"../chunks/each.893eae5b.js";import{m as Pe}from"../chunks/metadataStore.a1206dd8.js";import{f as ve}from"../chunks/index.87ccca6e.js";import{I as ke}from"../chunks/InteractionButton.ea47d7cf.js";import{i as Fe,s as We,C as ne,t as ze,g as ge,r as qe}from"../chunks/essayInteractionService.8e423a7a.js";function ye(r,n,t){const e=r.slice();return e[11]=n[t],e}function Ue(r){let n,t,e=me(r[0].essays),s=[];for(let o=0;o<e.length;o+=1)s[o]=Ee(ye(r,e,o));const l=o=>q(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();n=ue()},l(o){for(let i=0;i<s.length;i+=1)s[i].l(o);n=ue()},m(o,i){for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(o,i);F(o,n,i),t=!0},p(o,i){if(i&63){e=me(o[0].essays);let c;for(c=0;c<e.length;c+=1){const T=ye(o,e,c);s[c]?(s[c].p(T,i),P(s[c],1)):(s[c]=Ee(T),s[c].c(),P(s[c],1),s[c].m(n.parentNode,n))}for(re(),c=e.length;c<s.length;c+=1)l(c);se()}},i(o){if(!t){for(let i=0;i<e.length;i+=1)P(s[i]);t=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)q(s[i]);t=!1},d(o){o&&p(n),Ae(s,o)}}}function Be(r){let n,t,e="No essays found. Please check your database connection or create some essays.",s,l,o,i="Debug Essays Data",c,T;return{c(){n=g("div"),t=g("p"),t.textContent=e,s=V(),l=g("div"),o=g("button"),o.textContent=i,this.h()},l(D){n=y(D,"DIV",{class:!0});var b=S(n);t=y(b,"P",{"data-svelte-h":!0}),Y(t)!=="svelte-syp6t2"&&(t.textContent=e),s=A(b),l=y(b,"DIV",{class:!0});var m=S(l);o=y(m,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(o)!=="svelte-66ybsm"&&(o.textContent=i),m.forEach(p),b.forEach(p),this.h()},h(){_(o,"class","svelte-pf45a3"),_(l,"class","debug-actions svelte-pf45a3"),_(n,"class","no-essays svelte-pf45a3")},m(D,b){F(D,n,b),d(n,t),d(n,s),d(n,l),d(l,o),c||(T=Ne(o,"click",r[7]),c=!0)},p:te,i:te,o:te,d(D){D&&p(n),c=!1,T()}}}function Oe(r){let n=r[11].description+"",t;return{c(){t=O(n)},l(e){t=j(e,n)},m(e,s){F(e,t,s)},p(e,s){s&1&&n!==(n=e[11].description+"")&&J(t,n)},d(e){e&&p(t)}}}function je(r){let n=r[11].excerpt+"",t;return{c(){t=O(n)},l(e){t=j(e,n)},m(e,s){F(e,t,s)},p(e,s){s&1&&n!==(n=e[11].excerpt+"")&&J(t,n)},d(e){e&&p(t)}}}function be(r){let n,t,e,s;return{c(){n=g("div"),t=O(r[1]),this.h()},l(l){n=y(l,"DIV",{class:!0});var o=S(n);t=j(o,r[1]),o.forEach(p),this.h()},h(){_(n,"class","copy-feedback svelte-pf45a3")},m(l,o){F(l,n,o),d(n,t),s=!0},p(l,o){(!s||o&2)&&J(t,l[1])},i(l){s||(l&&Me(()=>{s&&(e||(e=_e(n,ve,{duration:150},!0)),e.run(1))}),s=!0)},o(l){l&&(e||(e=_e(n,ve,{duration:150},!1)),e.run(0)),s=!1},d(l){l&&p(n),l&&e&&e.end()}}}function we(r){let n=Te(r[11])+"",t;return{c(){t=O(n)},l(e){t=j(e,n)},m(e,s){F(e,t,s)},p(e,s){s&1&&n!==(n=Te(e[11])+"")&&J(t,n)},d(e){e&&p(t)}}}function Ee(r){let n,t,e,s,l=Ce(r[11].date)+"",o,i,c,T=r[11].title+"",D,b,m,C,a,v='<span class="read-more-text svelte-pf45a3">Read more</span> &gt;',u,$,f,h,k,M,H,W,Z,x,U,ee,B;function oe(E,L){return E[11].excerpt?je:Oe}let K=oe(r),N=K(r);function De(...E){return r[8](r[11],...E)}k=new ke({props:{type:"like",active:r[3][r[11].id]||!1,count:void 0}}),k.$on("click",De);function Le(...E){return r[9](r[11],...E)}W=new ke({props:{type:"share",active:!1,count:void 0}}),W.$on("click",Le);let w=r[1]&&r[2]===r[11].id&&be(r),I=r[11].id&&we(r);return{c(){n=g("div"),t=g("a"),e=g("div"),s=g("p"),o=O(l),i=V(),c=g("h3"),D=O(T),b=V(),m=g("p"),N.c(),C=V(),a=g("span"),a.innerHTML=v,$=V(),f=g("div"),h=g("div"),fe(k.$$.fragment),M=V(),H=g("div"),fe(W.$$.fragment),Z=V(),w&&w.c(),x=V(),U=g("div"),I&&I.c(),ee=V(),this.h()},l(E){n=y(E,"DIV",{class:!0});var L=S(n);t=y(L,"A",{href:!0,class:!0,"data-sveltekit-preload-data":!0});var R=S(t);e=y(R,"DIV",{class:!0});var z=S(e);s=y(z,"P",{class:!0});var ae=S(s);o=j(ae,l),ae.forEach(p),i=A(z),c=y(z,"H3",{class:!0});var le=S(c);D=j(le,T),le.forEach(p),b=A(z),m=y(z,"P",{class:!0});var ie=S(m);N.l(ie),ie.forEach(p),C=A(z),a=y(z,"SPAN",{class:!0,"data-svelte-h":!0}),Y(a)!=="svelte-1ishrws"&&(a.innerHTML=v),z.forEach(p),R.forEach(p),$=A(L),f=y(L,"DIV",{class:!0});var G=S(f);h=y(G,"DIV",{class:!0});var Q=S(h);de(k.$$.fragment,Q),M=A(Q),H=y(Q,"DIV",{class:!0});var X=S(H);de(W.$$.fragment,X),Z=A(X),w&&w.l(X),X.forEach(p),Q.forEach(p),x=A(G),U=y(G,"DIV",{class:!0});var ce=S(U);I&&I.l(ce),ce.forEach(p),G.forEach(p),ee=A(L),L.forEach(p),this.h()},h(){_(s,"class","essay-date svelte-pf45a3"),_(c,"class","essay-title svelte-pf45a3"),_(m,"class","essay-description"),_(a,"class","read-more svelte-pf45a3"),_(e,"class","essay-content svelte-pf45a3"),_(t,"href",u="/writing/"+r[11].slug),_(t,"class","essay-card-link svelte-pf45a3"),_(t,"data-sveltekit-preload-data","off"),_(H,"class","share-button-container svelte-pf45a3"),_(h,"class","essay-buttons svelte-pf45a3"),_(U,"class","essay-counters svelte-pf45a3"),_(f,"class","essay-interaction-container svelte-pf45a3"),_(n,"class","essay-card svelte-pf45a3")},m(E,L){F(E,n,L),d(n,t),d(t,e),d(e,s),d(s,o),d(e,i),d(e,c),d(c,D),d(e,b),d(e,m),N.m(m,null),d(e,C),d(e,a),d(n,$),d(n,f),d(f,h),he(k,h,null),d(h,M),d(h,H),he(W,H,null),d(H,Z),w&&w.m(H,null),d(f,x),d(f,U),I&&I.m(U,null),d(n,ee),B=!0},p(E,L){r=E,(!B||L&1)&&l!==(l=Ce(r[11].date)+"")&&J(o,l),(!B||L&1)&&T!==(T=r[11].title+"")&&J(D,T),K===(K=oe(r))&&N?N.p(r,L):(N.d(1),N=K(r),N&&(N.c(),N.m(m,null))),(!B||L&1&&u!==(u="/writing/"+r[11].slug))&&_(t,"href",u);const R={};L&9&&(R.active=r[3][r[11].id]||!1),k.$set(R),r[1]&&r[2]===r[11].id?w?(w.p(r,L),L&7&&P(w,1)):(w=be(r),w.c(),P(w,1),w.m(H,null)):w&&(re(),q(w,1,1,()=>{w=null}),se()),r[11].id?I?I.p(r,L):(I=we(r),I.c(),I.m(U,null)):I&&(I.d(1),I=null)},i(E){B||(P(k.$$.fragment,E),P(W.$$.fragment,E),P(w),B=!0)},o(E){q(k.$$.fragment,E),q(W.$$.fragment,E),q(w),B=!1},d(E){E&&p(n),N.d(),pe(k),pe(W),w&&w.d(),I&&I.d()}}}function Je(r){let n,t,e,s,l,o='Thoughts about <span class="purple">Software.</span>',i,c,T=`<p>How do our natural behaviors and cognitive patterns uncover opportunities
      to rethink software design and create tools that <span class="small-font svelte-pf45a3">quietly</span> complement our lives?</p>`,D,b,m,C,a;const v=[Be,Ue],u=[];function $(f,h){return!f[0].essays||f[0].essays.length===0?0:1}return m=$(r),C=u[m]=v[m](r),{c(){n=g("meta"),t=g("link"),e=V(),s=g("main"),l=g("h2"),l.innerHTML=o,i=V(),c=g("div"),c.innerHTML=T,D=V(),b=g("div"),C.c(),this.h()},l(f){const h=Ve("svelte-hwnoeq",document.head);n=y(h,"META",{name:!0,content:!0}),t=y(h,"LINK",{rel:!0,href:!0}),h.forEach(p),e=A(f),s=y(f,"MAIN",{class:!0});var k=S(s);l=y(k,"H2",{class:!0,"data-svelte-h":!0}),Y(l)!=="svelte-1l1gur7"&&(l.innerHTML=o),i=A(k),c=y(k,"DIV",{class:!0,"data-svelte-h":!0}),Y(c)!=="svelte-1dyp2ll"&&(c.innerHTML=T),D=A(k),b=y(k,"DIV",{class:!0});var M=S(b);C.l(M),M.forEach(p),k.forEach(p),this.h()},h(){document.title="Writing | Wendy Ham's Weekend Projects",_(n,"name","description"),_(n,"content","Thoughts about creating software that quietly complements our lives."),_(t,"rel","canonical"),_(t,"href","https://xnham.com/writing"),_(l,"class","small-bottom-margin"),_(c,"class","writing-intro svelte-pf45a3"),_(b,"class","essays svelte-pf45a3"),_(s,"class","container")},m(f,h){d(document.head,n),d(document.head,t),F(f,e,h),F(f,s,h),d(s,l),d(s,i),d(s,c),d(s,D),d(s,b),u[m].m(b,null),a=!0},p(f,[h]){let k=m;m=$(f),m===k?u[m].p(f,h):(re(),q(u[k],1,1,()=>{u[k]=null}),se(),C=u[m],C?C.p(f,h):(C=u[m]=v[m](f),C.c()),P(C,1),C.m(b,null))},i(f){a||(P(C),a=!0)},o(f){q(C),a=!1},d(f){f&&(p(e),p(s)),p(n),p(t),u[m].d()}}}function Ce(r){const[n,t,e]=r.split("-"),s=["January","February","March","April","May","June","July","August","September","October","November","December"],l=parseInt(t,10)-1,o=s[l],i=e.startsWith("0")?e.substring(1):e;return`${o} ${i}, ${n}`}function Te(r){const n=r.like_count||0,t=r.share_count||0;return n===0&&t===0?"":n>0&&t===0?`${n} ${n===1?"like":"likes"}`:n===0&&t>0?`${t} ${t===1?"share":"shares"}`:`${n} ${n===1?"like":"likes"} & ${t} ${t===1?"share":"shares"}`}function Re(r,n,t){let{data:e}=n,s="",l="",o=null,i={likes:{},shares:{},views:{}},c={};Ie(()=>{Pe.set({title:"Writing | Wendy Ham's Weekend Projects",description:"Thoughts about creating software that quietly complements our lives.",canonicalUrl:"https://xnham.com/writing",type:"website",url:window.location.href});try{console.log("Initializing interactions on writing list page"),Fe().then(u=>{console.log("Interactions initialized with device ID:",u),u||console.error("Failed to initialize interactions - no device ID returned")});let a=()=>{};try{a=We(u=>{console.log("Interaction state updated",u),t(6,i=u)})}catch(u){console.error("Error subscribing to interactions:",u)}const v=u=>{u.key==="Escape"&&(t(1,s=""),t(2,l=""))};return window.addEventListener("keydown",v),()=>{a(),window.removeEventListener("keydown",v),o&&clearTimeout(o)}}catch(a){return console.error("Error during interaction initialization:",a),()=>{o&&clearTimeout(o)}}});async function T(a){console.log("handleLike called with essayId:",a);try{const v=e.essays.find(M=>M.id===a);if(!v)return;const u=`${ne.ESSAY}:${a}`,f=(i==null?void 0:i.likes[u])||!1?-1:1,h=v.like_count||0,k=Math.max(0,h+f);v.like_count=k,console.log(`Optimistic update - like count for essay ${a}: ${h} â†’ ${k}`),await ze(a);try{const M=await ge(a);console.log(`Database counts for essay ${a}:`,M),t(0,e.essays=e.essays.map(H=>H.id===a?{...H,like_count:M.likeCount,share_count:M.shareCount,view_count:M.viewCount}:H),e)}catch(M){console.error("Error refreshing essay counts:",M)}}catch(v){console.error("Error toggling like:",v);const u=e.essays.find($=>$.id===a);if(u){const $=`${ne.ESSAY}:${a}`,h=(i==null?void 0:i.likes[$])||!1?1:-1;u.like_count=Math.max(0,(u.like_count||0)-h)}}}async function D(a){try{if(!a.id)return;const v=`${window.location.origin}/writing/${a.slug}`;await navigator.clipboard.writeText(v);const u=a.share_count||0,$=u+1;a.share_count=$,console.log(`Optimistic update - share count for essay ${a.id}: ${u} â†’ ${$}`),t(1,s="URL copied to clipboard!"),t(2,l=a.id),o&&clearTimeout(o),o=setTimeout(()=>{t(1,s=""),t(2,l="")},3e3),await qe(a.id);try{const f=await ge(a.id);console.log(`Database counts for essay ${a.id}:`,f),t(0,e.essays=e.essays.map(h=>h.id===a.id?{...h,like_count:f.likeCount,share_count:f.shareCount,view_count:f.viewCount}:h),e)}catch(f){console.error("Error refreshing essay counts:",f)}}catch(v){console.error("Error sharing essay:",v),t(1,s="Failed to copy URL"),t(2,l=a.id),o=setTimeout(()=>{t(1,s=""),t(2,l="")},3e3),a&&(a.share_count=Math.max(0,(a.share_count||0)-1))}}const b=()=>console.log("Essays data:",(e==null?void 0:e.essays)||"None"),m=(a,v)=>{console.log("Like button clicked in list view for:",a.id),T(a.id)},C=(a,v)=>{console.log("Share button clicked in list view for:",a.id),D(a)};return r.$$set=a=>{"data"in a&&t(0,e=a.data)},r.$$.update=()=>{var a;r.$$.dirty&65&&t(3,c=((a=e.essays)==null?void 0:a.reduce((v,u)=>{if(u.id){const $=`${ne.ESSAY}:${u.id}`;v[u.id]=(i==null?void 0:i.likes[$])||!1}return v},{}))||{})},[e,s,l,c,T,D,i,b,m,C]}class et extends Se{constructor(n){super(),He(this,n,Re,Je,$e,{data:0})}}export{et as component};
