import{S as Ne,T as Pe,U as re,V as qe,s as Ie,f as g,g as w,h as L,d as h,j as y,i as V,W as Ae,o as Le,e as O,M as Re,a as q,r as Q,c as A,w as _,x as We,y as C,l as F,m as z,n as Y,C as Fe,G as ze,q as pe}from"../chunks/scheduler.90cbc393.js";import{g as G,t as H,c as K,a as M,S as je,i as Me,b as ne,d as ue,m as se,e as oe,f as ve}from"../chunks/index.f2611f2d.js";import{m as Ue}from"../chunks/metadataStore.410d5ae1.js";import{e as ke}from"../chunks/each.23f806c3.js";import{f as ye}from"../chunks/index.f9edecbc.js";import{I as be}from"../chunks/InteractionButton.c0953185.js";import{i as Oe,s as Be,C as ce,t as Je,g as ge,r as Ye}from"../chunks/essayInteractionService.09dd6a5d.js";function Ge(s,e){const t=e.token={};function r(n,a,o,i){if(e.token!==t)return;e.resolved=i;let l=e.ctx;o!==void 0&&(l=l.slice(),l[o]=i);const u=n&&(e.current=n)(l);let k=!1;e.block&&(e.blocks?e.blocks.forEach((b,p)=>{p!==a&&b&&(G(),H(b,1,1,()=>{e.blocks[p]===b&&(e.blocks[p]=null)}),K())}):e.block.d(1),u.c(),M(u,1),u.m(e.mount(),e.anchor),k=!0),e.block=u,e.blocks&&(e.blocks[a]=u),k&&qe()}if(Ne(s)){const n=Pe();if(s.then(a=>{re(n),r(e.then,1,e.value,a),re(null)},a=>{if(re(n),r(e.catch,2,e.error,a),re(null),!e.hasCatch)throw a}),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,s),!0;e.resolved=s}}function Ke(s,e,t){const r=e.slice(),{resolved:n}=s;s.current===s.then&&(r[s.value]=n),s.current===s.catch&&(r[s.error]=n),s.block.p(r,t)}function we(s,e,t){const r=s.slice();return r[12]=e[t],r}function Xe(s){let e,t,r=ke(s[0]),n=[];for(let o=0;o<r.length;o+=1)n[o]=Te(we(s,r,o));const a=o=>H(n[o],1,1,()=>{n[o]=null});return{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=O()},l(o){for(let i=0;i<n.length;i+=1)n[i].l(o);e=O()},m(o,i){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(o,i);V(o,e,i),t=!0},p(o,i){if(i&63){r=ke(o[0]);let l;for(l=0;l<r.length;l+=1){const u=we(o,r,l);n[l]?(n[l].p(u,i),M(n[l],1)):(n[l]=Te(u),n[l].c(),M(n[l],1),n[l].m(e.parentNode,e))}for(G(),l=r.length;l<n.length;l+=1)a(l);K()}},i(o){if(!t){for(let i=0;i<r.length;i+=1)M(n[i]);t=!0}},o(o){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)H(n[i]);t=!1},d(o){o&&h(e),Re(n,o)}}}function Qe(s){let e,t,r="No essays found. Please check your database connection or create some essays.",n,a,o,i="Debug Essays Data",l,u;return{c(){e=g("div"),t=g("p"),t.textContent=r,n=q(),a=g("div"),o=g("button"),o.textContent=i,this.h()},l(k){e=w(k,"DIV",{class:!0});var b=L(e);t=w(b,"P",{"data-svelte-h":!0}),Q(t)!=="svelte-syp6t2"&&(t.textContent=r),n=A(b),a=w(b,"DIV",{class:!0});var p=L(a);o=w(p,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(o)!=="svelte-p33n27"&&(o.textContent=i),p.forEach(h),b.forEach(h),this.h()},h(){y(o,"class","svelte-1my1pjd"),y(a,"class","debug-actions svelte-1my1pjd"),y(e,"class","no-essays svelte-1my1pjd")},m(k,b){V(k,e,b),_(e,t),_(e,n),_(e,a),_(a,o),l||(u=We(o,"click",s[7]),l=!0)},p:C,i:C,o:C,d(k){k&&h(e),l=!1,u()}}}function Ze(s){let e=s[12].description+"",t;return{c(){t=F(e)},l(r){t=z(r,e)},m(r,n){V(r,t,n)},p(r,n){n&1&&e!==(e=r[12].description+"")&&Y(t,e)},d(r){r&&h(t)}}}function xe(s){let e=s[12].excerpt+"",t;return{c(){t=F(e)},l(r){t=z(r,e)},m(r,n){V(r,t,n)},p(r,n){n&1&&e!==(e=r[12].excerpt+"")&&Y(t,e)},d(r){r&&h(t)}}}function Ee(s){let e,t,r,n;return{c(){e=g("div"),t=F(s[1]),this.h()},l(a){e=w(a,"DIV",{class:!0});var o=L(e);t=z(o,s[1]),o.forEach(h),this.h()},h(){y(e,"class","copy-feedback svelte-1my1pjd")},m(a,o){V(a,e,o),_(e,t),n=!0},p(a,o){(!n||o&2)&&Y(t,a[1])},i(a){n||(a&&Fe(()=>{n&&(r||(r=ve(e,ye,{duration:150},!0)),r.run(1))}),n=!0)},o(a){a&&(r||(r=ve(e,ye,{duration:150},!1)),r.run(0)),n=!1},d(a){a&&h(e),a&&r&&r.end()}}}function $e(s){let e=De(s[12])+"",t;return{c(){t=F(e)},l(r){t=z(r,e)},m(r,n){V(r,t,n)},p(r,n){n&1&&e!==(e=De(r[12])+"")&&Y(t,e)},d(r){r&&h(t)}}}function Te(s){let e,t,r,n,a=Ce(s[12].date)+"",o,i,l,u=s[12].title+"",k,b,p,D,N,c='<span class="read-more-text svelte-1my1pjd">Read more</span> &gt;',f,E,d,m,v,W,I,P,le,ae,B,ie,J;function de(T,j){return T[12].excerpt?xe:Ze}let Z=de(s),R=Z(s);function Ve(...T){return s[8](s[12],...T)}v=new be({props:{type:"like",active:s[3][s[12].id]||!1,count:void 0}}),v.$on("click",Ve);function He(...T){return s[9](s[12],...T)}P=new be({props:{type:"share",active:!1,count:void 0}}),P.$on("click",He);let $=s[1]&&s[2]===s[12].id&&Ee(s),S=s[12].id&&$e(s);return{c(){e=g("div"),t=g("a"),r=g("div"),n=g("p"),o=F(a),i=q(),l=g("h3"),k=F(u),b=q(),p=g("p"),R.c(),D=q(),N=g("span"),N.innerHTML=c,E=q(),d=g("div"),m=g("div"),ne(v.$$.fragment),W=q(),I=g("div"),ne(P.$$.fragment),le=q(),$&&$.c(),ae=q(),B=g("div"),S&&S.c(),ie=q(),this.h()},l(T){e=w(T,"DIV",{class:!0});var j=L(e);t=w(j,"A",{href:!0,class:!0,"data-sveltekit-preload-data":!0});var X=L(t);r=w(X,"DIV",{class:!0});var U=L(r);n=w(U,"P",{class:!0});var fe=L(n);o=z(fe,a),fe.forEach(h),i=A(U),l=w(U,"H3",{class:!0});var he=L(l);k=z(he,u),he.forEach(h),b=A(U),p=w(U,"P",{class:!0});var _e=L(p);R.l(_e),_e.forEach(h),D=A(U),N=w(U,"SPAN",{class:!0,"data-svelte-h":!0}),Q(N)!=="svelte-wq4u18"&&(N.innerHTML=c),U.forEach(h),X.forEach(h),E=A(j),d=w(j,"DIV",{class:!0});var x=L(d);m=w(x,"DIV",{class:!0});var ee=L(m);ue(v.$$.fragment,ee),W=A(ee),I=w(ee,"DIV",{class:!0});var te=L(I);ue(P.$$.fragment,te),le=A(te),$&&$.l(te),te.forEach(h),ee.forEach(h),ae=A(x),B=w(x,"DIV",{class:!0});var me=L(B);S&&S.l(me),me.forEach(h),x.forEach(h),ie=A(j),j.forEach(h),this.h()},h(){y(n,"class","essay-date svelte-1my1pjd"),y(l,"class","essay-title svelte-1my1pjd"),y(p,"class","essay-description"),y(N,"class","read-more svelte-1my1pjd"),y(r,"class","essay-content svelte-1my1pjd"),y(t,"href",f="/writing/"+s[12].slug),y(t,"class","essay-card-link svelte-1my1pjd"),y(t,"data-sveltekit-preload-data","off"),y(I,"class","share-button-container svelte-1my1pjd"),y(m,"class","essay-buttons svelte-1my1pjd"),y(B,"class","essay-counters svelte-1my1pjd"),y(d,"class","essay-interaction-container svelte-1my1pjd"),y(e,"class","essay-card svelte-1my1pjd")},m(T,j){V(T,e,j),_(e,t),_(t,r),_(r,n),_(n,o),_(r,i),_(r,l),_(l,k),_(r,b),_(r,p),R.m(p,null),_(r,D),_(r,N),_(e,E),_(e,d),_(d,m),se(v,m,null),_(m,W),_(m,I),se(P,I,null),_(I,le),$&&$.m(I,null),_(d,ae),_(d,B),S&&S.m(B,null),_(e,ie),J=!0},p(T,j){s=T,(!J||j&1)&&a!==(a=Ce(s[12].date)+"")&&Y(o,a),(!J||j&1)&&u!==(u=s[12].title+"")&&Y(k,u),Z===(Z=de(s))&&R?R.p(s,j):(R.d(1),R=Z(s),R&&(R.c(),R.m(p,null))),(!J||j&1&&f!==(f="/writing/"+s[12].slug))&&y(t,"href",f);const X={};j&9&&(X.active=s[3][s[12].id]||!1),v.$set(X),s[1]&&s[2]===s[12].id?$?($.p(s,j),j&7&&M($,1)):($=Ee(s),$.c(),M($,1),$.m(I,null)):$&&(G(),H($,1,1,()=>{$=null}),K()),s[12].id?S?S.p(s,j):(S=$e(s),S.c(),S.m(B,null)):S&&(S.d(1),S=null)},i(T){J||(M(v.$$.fragment,T),M(P.$$.fragment,T),M($),J=!0)},o(T){H(v.$$.fragment,T),H(P.$$.fragment,T),H($),J=!1},d(T){T&&h(e),R.d(),oe(v),oe(P),$&&$.d(),S&&S.d()}}}function et(s){let e,t,r,n;const a=[Qe,Xe],o=[];function i(l,u){return!l[0]||l[0].length===0?0:1}return t=i(s),r=o[t]=a[t](s),{c(){e=g("div"),r.c(),this.h()},l(l){e=w(l,"DIV",{class:!0});var u=L(e);r.l(u),u.forEach(h),this.h()},h(){y(e,"class","essays svelte-1my1pjd")},m(l,u){V(l,e,u),o[t].m(e,null),n=!0},p(l,[u]){let k=t;t=i(l),t===k?o[t].p(l,u):(G(),H(o[k],1,1,()=>{o[k]=null}),K(),r=o[t],r?r.p(l,u):(r=o[t]=a[t](l),r.c()),M(r,1),r.m(e,null))},i(l){n||(M(r),n=!0)},o(l){H(r),n=!1},d(l){l&&h(e),o[t].d()}}}function Ce(s){const[e,t,r]=s.split("-"),n=["January","February","March","April","May","June","July","August","September","October","November","December"],a=parseInt(t,10)-1,o=n[a],i=r.startsWith("0")?r.substring(1):r;return`${o} ${i}, ${e}`}function De(s){const e=s.like_count||0,t=s.share_count||0;return e===0&&t===0?"":e>0&&t===0?`${e} ${e===1?"like":"likes"}`:e===0&&t>0?`${t} ${t===1?"share":"shares"}`:`${e} ${e===1?"like":"likes"} & ${t} ${t===1?"share":"shares"}`}function tt(s,e,t){const r=Ae();let{essays:n=[]}=e,a="",o="",i=null,l={likes:{},shares:{},views:{}},u={};Le(()=>{console.log("Initializing interactions on Essays component");let c=()=>{},f=null;try{f=setTimeout(async()=>{try{const d=await Oe();if(console.log("Interactions initialized with device ID:",d),!d){console.error("Failed to initialize interactions - no device ID returned"),r("error",new Error("Failed to initialize interactions"));return}c=Be(m=>{console.log("Interaction state updated",m),t(6,l=m)})}catch(d){console.error("Error during delayed interaction initialization:",d),r("error",d)}},300);const E=d=>{d.key==="Escape"&&(t(1,a=""),t(2,o=""))};return window.addEventListener("keydown",E),()=>{f&&clearTimeout(f),c(),window.removeEventListener("keydown",E),i&&clearTimeout(i)}}catch(E){return console.error("Error setting up Essays component:",E),r("error",E),()=>{f&&clearTimeout(f),c(),i&&clearTimeout(i)}}});async function k(c){console.log("handleLike called with essayId:",c);try{const f=n.find(I=>I.id===c);if(!f)return;const E=`${ce.ESSAY}:${c}`,m=(l==null?void 0:l.likes[E])||!1?-1:1,v=f.like_count||0,W=Math.max(0,v+m);f.like_count=W,console.log(`Optimistic update - like count for essay ${c}: ${v} → ${W}`),await Je(c);try{const I=await ge(c);console.log(`Database counts for essay ${c}:`,I),t(0,n=n.map(P=>P.id===c?{...P,like_count:I.likeCount,share_count:I.shareCount,view_count:I.viewCount}:P))}catch(I){console.error("Error refreshing essay counts:",I)}}catch(f){console.error("Error toggling like:",f),r("error",f);const E=n.find(d=>d.id===c);if(E){const d=`${ce.ESSAY}:${c}`,v=(l==null?void 0:l.likes[d])||!1?1:-1;E.like_count=Math.max(0,(E.like_count||0)-v)}}}async function b(c){try{if(!c.id)return;const f=`${window.location.origin}/writing/${c.slug}`;await navigator.clipboard.writeText(f);const E=c.share_count||0,d=E+1;c.share_count=d,console.log(`Optimistic update - share count for essay ${c.id}: ${E} → ${d}`),t(1,a="URL copied to clipboard!"),t(2,o=c.id),i&&clearTimeout(i),i=setTimeout(()=>{t(1,a=""),t(2,o="")},3e3),await Ye(c.id);try{const m=await ge(c.id);console.log(`Database counts for essay ${c.id}:`,m),t(0,n=n.map(v=>v.id===c.id?{...v,like_count:m.likeCount,share_count:m.shareCount,view_count:m.viewCount}:v))}catch(m){console.error("Error refreshing essay counts:",m)}}catch(f){console.error("Error sharing essay:",f),r("error",f),t(1,a="Failed to copy URL"),t(2,o=c.id),i=setTimeout(()=>{t(1,a=""),t(2,o="")},3e3),c&&(c.share_count=Math.max(0,(c.share_count||0)-1))}}const p=()=>console.log("Essays data:",n||"None"),D=(c,f)=>{console.log("Like button clicked in list view for:",c.id),k(c.id)},N=(c,f)=>{console.log("Share button clicked in list view for:",c.id),b(c)};return s.$$set=c=>{"essays"in c&&t(0,n=c.essays)},s.$$.update=()=>{s.$$.dirty&65&&t(3,u=(n==null?void 0:n.reduce((c,f)=>{if(f.id){const E=`${ce.ESSAY}:${f.id}`;c[f.id]=(l==null?void 0:l.likes[E])||!1}return c},{}))||{})},[n,a,o,u,k,b,l,p,D,N]}class rt extends je{constructor(e){super(),Me(this,e,tt,et,Ie,{essays:0})}}function nt(s){let e,t,r={ctx:s,current:null,token:null,hasCatch:!1,pending:it,then:lt,catch:ot,value:5,blocks:[,,,]};return Ge(Promise.resolve(s[3]()),r),{c(){e=O(),r.block.c()},l(n){e=O(),r.block.l(n)},m(n,a){V(n,e,a),r.block.m(n,r.anchor=a),r.mount=()=>e.parentNode,r.anchor=e,t=!0},p(n,a){s=n,Ke(r,s,a)},i(n){t||(M(r.block),t=!0)},o(n){for(let a=0;a<3;a+=1){const o=r.blocks[a];H(o)}t=!1},d(n){n&&h(e),r.block.d(n),r.token=null,r=null}}}function st(s){let e,t,r;function n(i,l){return i[1]>=Se?ut:ct}let a=n(s),o=a(s);return{c(){e=g("div"),t=g("p"),r=F(`There was an error loading the essays. 
          `),o.c(),this.h()},l(i){e=w(i,"DIV",{class:!0});var l=L(e);t=w(l,"P",{});var u=L(t);r=z(u,`There was an error loading the essays. 
          `),o.l(u),u.forEach(h),l.forEach(h),this.h()},h(){y(e,"class","error-message svelte-c611qv")},m(i,l){V(i,e,l),_(e,t),_(t,r),o.m(t,null)},p(i,l){a!==(a=n(i))&&(o.d(1),o=a(i),o&&(o.c(),o.m(t,null)))},i:C,o:C,d(i){i&&h(e),o.d()}}}function ot(s){return{c:C,l:C,m:C,p:C,i:C,o:C,d:C}}function lt(s){let e,t,r=s[5]&&at(s);return{c(){r&&r.c(),e=O()},l(n){r&&r.l(n),e=O()},m(n,a){r&&r.m(n,a),V(n,e,a),t=!0},p(n,a){n[5]&&r.p(n,a)},i(n){t||(M(r),t=!0)},o(n){H(r),t=!1},d(n){n&&h(e),r&&r.d(n)}}}function at(s){let e,t,r;var n=s[5].component;function a(o,i){return{props:{essays:o[5].props.essays}}}return n&&(e=pe(n,a(s)),e.$on("error",s[2])),{c(){e&&ne(e.$$.fragment),t=O()},l(o){e&&ue(e.$$.fragment,o),t=O()},m(o,i){e&&se(e,o,i),V(o,t,i),r=!0},p(o,i){if(n!==(n=o[5].component)){if(e){G();const l=e;H(l.$$.fragment,1,0,()=>{oe(l,1)}),K()}n?(e=pe(n,a(o)),e.$on("error",o[2]),ne(e.$$.fragment),M(e.$$.fragment,1),se(e,t.parentNode,t)):e=null}},i(o){r||(e&&M(e.$$.fragment,o),r=!0)},o(o){e&&H(e.$$.fragment,o),r=!1},d(o){o&&h(t),e&&oe(e,o)}}}function it(s){return{c:C,l:C,m:C,p:C,i:C,o:C,d:C}}function ct(s){let e;return{c(){e=F("Retrying...")},l(t){e=z(t,"Retrying...")},m(t,r){V(t,e,r)},d(t){t&&h(e)}}}function ut(s){let e;return{c(){e=F("Please try refreshing the page.")},l(t){e=z(t,"Please try refreshing the page.")},m(t,r){V(t,e,r)},d(t){t&&h(e)}}}function dt(s){let e,t,r,n,a,o='Thoughts about <span class="purple">Software.</span>',i,l,u=`<p>How do our natural behaviors and cognitive patterns uncover opportunities
      to rethink software design and create tools that <span class="small-font svelte-c611qv">quietly</span> complement our lives?</p>`,k,b,p,D,N;const c=[st,nt],f=[];function E(d,m){return d[0]?0:1}return p=E(s),D=f[p]=c[p](s),{c(){e=g("meta"),t=g("link"),r=q(),n=g("main"),a=g("h2"),a.innerHTML=o,i=q(),l=g("div"),l.innerHTML=u,k=q(),b=g("div"),D.c(),this.h()},l(d){const m=ze("svelte-hwnoeq",document.head);e=w(m,"META",{name:!0,content:!0}),t=w(m,"LINK",{rel:!0,href:!0}),m.forEach(h),r=A(d),n=w(d,"MAIN",{class:!0});var v=L(n);a=w(v,"H2",{class:!0,"data-svelte-h":!0}),Q(a)!=="svelte-1l1gur7"&&(a.innerHTML=o),i=A(v),l=w(v,"DIV",{class:!0,"data-svelte-h":!0}),Q(l)!=="svelte-1dyp2ll"&&(l.innerHTML=u),k=A(v),b=w(v,"DIV",{class:!0});var W=L(b);D.l(W),W.forEach(h),v.forEach(h),this.h()},h(){document.title="Writing | Wendy Ham's Weekend Projects",y(e,"name","description"),y(e,"content","Thoughts about creating software that quietly complements our lives."),y(t,"rel","canonical"),y(t,"href","https://xnham.com/writing"),y(a,"class","small-bottom-margin"),y(l,"class","writing-intro svelte-c611qv"),y(b,"class","essays-container svelte-c611qv"),y(n,"class","container")},m(d,m){_(document.head,e),_(document.head,t),V(d,r,m),V(d,n,m),_(n,a),_(n,i),_(n,l),_(n,k),_(n,b),f[p].m(b,null),N=!0},p(d,[m]){let v=p;p=E(d),p===v?f[p].p(d,m):(G(),H(f[v],1,1,()=>{f[v]=null}),K(),D=f[p],D?D.p(d,m):(D=f[p]=c[p](d),D.c()),M(D,1),D.m(b,null))},i(d){N||(M(D),N=!0)},o(d){H(D),N=!1},d(d){d&&(h(r),h(n)),h(e),h(t),f[p].d()}}}const Se=2;function ft(s,e,t){let{data:r}=e,n=!1,a=0;function o(l){console.error("Error in Essays component:",l.detail),t(0,n=!0),a<Se&&(t(1,a++,a),setTimeout(()=>{console.log(`Retry attempt ${a} for Essays component`),t(0,n=!1)},1e3))}function i(){try{return{component:rt,props:{essays:r.essays}}}catch(l){return console.error("Error while preparing Essays component:",l),t(0,n=!0),null}}return Le(()=>{Ue.set({title:"Writing | Wendy Ham's Weekend Projects",description:"Thoughts about creating software that quietly complements our lives.",canonicalUrl:"https://xnham.com/writing",type:"website",url:window.location.href});const l=u=>{console.error("Global error caught:",u.error||u.message);const k=String(u.error||u.message);(k.includes("Essays")||k.includes("essay")||k.includes("interaction"))&&(t(0,n=!0),u.preventDefault())};return window.addEventListener("error",l),()=>{window.removeEventListener("error",l)}}),s.$$set=l=>{"data"in l&&t(4,r=l.data)},[n,a,o,i,r]}class bt extends je{constructor(e){super(),Me(this,e,ft,dt,Ie,{data:4})}}export{bt as component};
