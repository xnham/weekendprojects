import{s as Te,f as m,g as _,h as L,d as f,j as h,i as V,S as He,o as Ie,e as he,M as Ve,r as O,y as K,l as F,m as B,w as d,n as Y,a as N,c as R,C as Ce,G as Ae}from"../chunks/scheduler.0abf8665.js";import{S as Le,i as ze,g as te,t as j,c as re,a as P,b as oe,d as se,m as le,e as ie,f as pe}from"../chunks/index.6a57b9dd.js";import{m as Pe}from"../chunks/metadataStore.3f488aae.js";import{e as me}from"../chunks/each.37ea5df4.js";import{f as _e}from"../chunks/index.da8dadf4.js";import{s as qe}from"../chunks/supabase.8f09c013.js";import{I as ve}from"../chunks/InteractionButton.03864e64.js";import{i as We,s as Ne,C as Re,t as je,r as Fe}from"../chunks/essayInteractionService.c4fe877c.js";function ge(o,e,t){const r=o.slice();return r[16]=e[t],r}function Be(o){let e,t,r=me(o[0]),n=[];for(let s=0;s<r.length;s+=1)n[s]=we(ge(o,r,s));const i=s=>j(n[s],1,1,()=>{n[s]=null});return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=he()},l(s){for(let c=0;c<n.length;c+=1)n[c].l(s);e=he()},m(s,c){for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(s,c);V(s,e,c),t=!0},p(s,c){if(c&249){r=me(s[0]);let a;for(a=0;a<r.length;a+=1){const u=ge(s,r,a);n[a]?(n[a].p(u,c),P(n[a],1)):(n[a]=we(u),n[a].c(),P(n[a],1),n[a].m(e.parentNode,e))}for(te(),a=r.length;a<n.length;a+=1)i(a);re()}},i(s){if(!t){for(let c=0;c<r.length;c+=1)P(n[c]);t=!0}},o(s){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)j(n[c]);t=!1},d(s){s&&f(e),Ve(n,s)}}}function Ue(o){let e,t="<p>No essays found. Check back soon!</p>";return{c(){e=m("div"),e.innerHTML=t,this.h()},l(r){e=_(r,"DIV",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-9tlz20"&&(e.innerHTML=t),this.h()},h(){h(e,"class","no-essays svelte-11wzf28")},m(r,n){V(r,e,n)},p:K,i:K,o:K,d(r){r&&f(e)}}}function Ke(o){let e,t,r,n;return{c(){e=m("div"),t=m("p"),r=F("Error: "),n=F(o[2]),this.h()},l(i){e=_(i,"DIV",{class:!0});var s=L(e);t=_(s,"P",{});var c=L(t);r=B(c,"Error: "),n=B(c,o[2]),c.forEach(f),s.forEach(f),this.h()},h(){h(e,"class","error-state svelte-11wzf28")},m(i,s){V(i,e,s),d(e,t),d(t,r),d(t,n)},p(i,s){s&4&&Y(n,i[2])},i:K,o:K,d(i){i&&f(e)}}}function $e(o){let e,t="<p>Loading essays...</p>";return{c(){e=m("div"),e.innerHTML=t,this.h()},l(r){e=_(r,"DIV",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-4id6j2"&&(e.innerHTML=t),this.h()},h(){h(e,"class","loading-state svelte-11wzf28")},m(r,n){V(r,e,n)},p:K,i:K,o:K,d(r){r&&f(e)}}}function Ge(o){let e=o[16].description+"",t;return{c(){t=F(e)},l(r){t=B(r,e)},m(r,n){V(r,t,n)},p(r,n){n&1&&e!==(e=r[16].description+"")&&Y(t,e)},d(r){r&&f(t)}}}function Xe(o){let e=o[16].excerpt+"",t;return{c(){t=F(e)},l(r){t=B(r,e)},m(r,n){V(r,t,n)},p(r,n){n&1&&e!==(e=r[16].excerpt+"")&&Y(t,e)},d(r){r&&f(t)}}}function ye(o){let e,t,r,n;return{c(){e=m("div"),t=F(o[3]),this.h()},l(i){e=_(i,"DIV",{class:!0});var s=L(e);t=B(s,o[3]),s.forEach(f),this.h()},h(){h(e,"class","copy-feedback svelte-11wzf28")},m(i,s){V(i,e,s),d(e,t),n=!0},p(i,s){(!n||s&8)&&Y(t,i[3])},i(i){n||(i&&Ce(()=>{n&&(r||(r=pe(e,_e,{duration:150},!0)),r.run(1))}),n=!0)},o(i){i&&(r||(r=pe(e,_e,{duration:150},!1)),r.run(0)),n=!1},d(i){i&&f(e),i&&r&&r.end()}}}function ke(o){let e=Ee(o[16])+"",t;return{c(){t=F(e)},l(r){t=B(r,e)},m(r,n){V(r,t,n)},p(r,n){n&1&&e!==(e=Ee(r[16])+"")&&Y(t,e)},d(r){r&&f(t)}}}function we(o){let e,t,r,n,i=be(o[16].date)+"",s,c,a,u=o[16].title+"",g,S,z,C,q,$='<span class="read-more-text svelte-11wzf28">Read more</span> &gt;',H,I,y,l,p,k,w,v,E,A,U,ne,X;function ae(T,M){return T[16].excerpt?Xe:Ge}let Q=ae(o),W=Q(o);function De(...T){return o[11](o[16],...T)}p=new ve({props:{type:"like",active:o[5][o[16].id]||!1,count:void 0}}),p.$on("click",De);function Se(...T){return o[12](o[16],...T)}v=new ve({props:{type:"share",active:!1,count:void 0}}),v.$on("click",Se);let b=o[3]&&o[4]===o[16].id&&ye(o),D=o[16].id&&ke(o);return{c(){e=m("div"),t=m("a"),r=m("div"),n=m("p"),s=F(i),c=N(),a=m("h3"),g=F(u),S=N(),z=m("p"),W.c(),C=N(),q=m("span"),q.innerHTML=$,I=N(),y=m("div"),l=m("div"),oe(p.$$.fragment),k=N(),w=m("div"),oe(v.$$.fragment),E=N(),b&&b.c(),A=N(),U=m("div"),D&&D.c(),ne=N(),this.h()},l(T){e=_(T,"DIV",{class:!0});var M=L(e);t=_(M,"A",{href:!0,class:!0,"data-sveltekit-preload-data":!0});var J=L(t);r=_(J,"DIV",{class:!0});var G=L(r);n=_(G,"P",{class:!0});var ce=L(n);s=B(ce,i),ce.forEach(f),c=R(G),a=_(G,"H3",{class:!0});var ue=L(a);g=B(ue,u),ue.forEach(f),S=R(G),z=_(G,"P",{class:!0});var fe=L(z);W.l(fe),fe.forEach(f),C=R(G),q=_(G,"SPAN",{class:!0,"data-svelte-h":!0}),O(q)!=="svelte-wq4u18"&&(q.innerHTML=$),G.forEach(f),J.forEach(f),I=R(M),y=_(M,"DIV",{class:!0});var Z=L(y);l=_(Z,"DIV",{class:!0});var x=L(l);se(p.$$.fragment,x),k=R(x),w=_(x,"DIV",{class:!0});var ee=L(w);se(v.$$.fragment,ee),E=R(ee),b&&b.l(ee),ee.forEach(f),x.forEach(f),A=R(Z),U=_(Z,"DIV",{class:!0});var de=L(U);D&&D.l(de),de.forEach(f),Z.forEach(f),ne=R(M),M.forEach(f),this.h()},h(){h(n,"class","essay-date svelte-11wzf28"),h(a,"class","essay-title svelte-11wzf28"),h(z,"class","essay-description"),h(q,"class","read-more svelte-11wzf28"),h(r,"class","essay-content svelte-11wzf28"),h(t,"href",H="/writing/"+o[16].slug),h(t,"class","essay-card-link svelte-11wzf28"),h(t,"data-sveltekit-preload-data","off"),h(w,"class","share-button-container svelte-11wzf28"),h(l,"class","essay-buttons svelte-11wzf28"),h(U,"class","essay-counters svelte-11wzf28"),h(y,"class","essay-interaction-container svelte-11wzf28"),h(e,"class","essay-card svelte-11wzf28")},m(T,M){V(T,e,M),d(e,t),d(t,r),d(r,n),d(n,s),d(r,c),d(r,a),d(a,g),d(r,S),d(r,z),W.m(z,null),d(r,C),d(r,q),d(e,I),d(e,y),d(y,l),le(p,l,null),d(l,k),d(l,w),le(v,w,null),d(w,E),b&&b.m(w,null),d(y,A),d(y,U),D&&D.m(U,null),d(e,ne),X=!0},p(T,M){o=T,(!X||M&1)&&i!==(i=be(o[16].date)+"")&&Y(s,i),(!X||M&1)&&u!==(u=o[16].title+"")&&Y(g,u),Q===(Q=ae(o))&&W?W.p(o,M):(W.d(1),W=Q(o),W&&(W.c(),W.m(z,null))),(!X||M&1&&H!==(H="/writing/"+o[16].slug))&&h(t,"href",H);const J={};M&33&&(J.active=o[5][o[16].id]||!1),p.$set(J),o[3]&&o[4]===o[16].id?b?(b.p(o,M),M&25&&P(b,1)):(b=ye(o),b.c(),P(b,1),b.m(w,null)):b&&(te(),j(b,1,1,()=>{b=null}),re()),o[16].id?D?D.p(o,M):(D=ke(o),D.c(),D.m(U,null)):D&&(D.d(1),D=null)},i(T){X||(P(p.$$.fragment,T),P(v.$$.fragment,T),P(b),X=!0)},o(T){j(p.$$.fragment,T),j(v.$$.fragment,T),j(b),X=!1},d(T){T&&f(e),W.d(),ie(p),ie(v),b&&b.d(),D&&D.d()}}}function Ye(o){let e,t,r,n;const i=[$e,Ke,Ue,Be],s=[];function c(a,u){return a[1]?0:a[2]?1:a[0].length===0?2:3}return t=c(o),r=s[t]=i[t](o),{c(){e=m("div"),r.c(),this.h()},l(a){e=_(a,"DIV",{class:!0});var u=L(e);r.l(u),u.forEach(f),this.h()},h(){h(e,"class","essays svelte-11wzf28")},m(a,u){V(a,e,u),s[t].m(e,null),n=!0},p(a,[u]){let g=t;t=c(a),t===g?s[t].p(a,u):(te(),j(s[g],1,1,()=>{s[g]=null}),re(),r=s[t],r?r.p(a,u):(r=s[t]=i[t](a),r.c()),P(r,1),r.m(e,null))},i(a){n||(P(r),n=!0)},o(a){j(r),n=!1},d(a){a&&f(e),s[t].d()}}}function be(o){if(!o)return"";try{return new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch(e){return console.error("Error formatting date:",e),o}}function Ee(o){const e=o.like_count||0,t=o.share_count||0,r=o.view_count||0;let n="";return e>0&&(n+=`${e} ${e===1?"like":"likes"}`),t>0&&(n&&(n+=" · "),n+=`${t} ${t===1?"share":"shares"}`),r>0&&(n&&(n+=" · "),n+=`${r} ${r===1?"view":"views"}`),n||"No interactions yet"}function Je(o,e,t){let{preloadedEssays:r=[]}=e,{serverError:n=null}=e;const i=He();let s=r||[],c=!r.length,a=n,u="",g="",S=null,z={likes:{},shares:{},views:{}},C={};async function q(){if(r.length>0){console.log("Using preloaded essays, skipping client-side fetch");return}try{console.log("Loading essays from Supabase...");const{data:l,error:p}=await qe.from("essays").select(`
          id, title, description, date, published, excerpt, slug,
          like_count, share_count, view_count
        `).eq("published",!0).order("date",{ascending:!1});if(p)throw p;console.log(`Successfully loaded ${(l==null?void 0:l.length)||0} essays from Supabase`),t(0,s=l||[]),t(1,c=!1)}catch(l){console.error("Error loading essays:",l),t(2,a=l instanceof Error?l.message:"Failed to load essays"),t(1,c=!1),i("error",l)}}async function $(l){if(l){console.log(`Like button clicked for essay: ${l}`);try{const p=await je(l);console.log(`New like status for essay ${l}:`,p)}catch(p){console.error(`Error toggling like for essay ${l}:`,p),i("error",p)}}}async function H(l){if(!(l!=null&&l.id)||!(l!=null&&l.slug))return;console.log(`Share button clicked for essay: ${l.id}`);const p=`https://xnham.com/writing/${l.slug}`;try{navigator.share?(await navigator.share({title:l.title,text:l.description||l.excerpt||"Check out this essay",url:p}),console.log("Successfully shared via Web Share API"),t(3,u="Shared!")):(await navigator.clipboard.writeText(p),console.log("URL copied to clipboard"),t(3,u="Link copied!")),t(4,g=l.id),await Fe(l.id),S&&clearTimeout(S),S=setTimeout(()=>{t(3,u=""),t(4,g="")},2e3)}catch(k){console.error("Error sharing essay:",k),t(3,u="Error sharing"),t(4,g=l.id),S&&clearTimeout(S),S=setTimeout(()=>{t(3,u=""),t(4,g="")},2e3),i("error",k)}}Ie(()=>{console.log("Initializing interactions on Essays component");let l=()=>{},p=null;try{p=setTimeout(async()=>{try{const w=await We();if(console.log("Interactions initialized with device ID:",w),!w){console.error("Failed to initialize interactions - no device ID returned"),i("error",new Error("Failed to initialize interactions"));return}await q(),l=Ne(v=>{console.log("Interaction state updated",v),t(10,z=v)})}catch(w){console.error("Error during delayed interaction initialization:",w),i("error",w)}},300);const k=w=>{w.key==="Escape"&&(t(3,u=""),t(4,g=""))};return window.addEventListener("keydown",k),()=>{l&&l(),p&&clearTimeout(p),S&&clearTimeout(S),window.removeEventListener("keydown",k)}}catch(k){console.error("Error in Essays component onMount:",k),i("error",k)}});const I=(l,p)=>{console.log("Like button clicked in list view for:",l.id),$(l.id)},y=(l,p)=>{console.log("Share button clicked in list view for:",l.id),H(l)};return o.$$set=l=>{"preloadedEssays"in l&&t(8,r=l.preloadedEssays),"serverError"in l&&t(9,n=l.serverError)},o.$$.update=()=>{o.$$.dirty&1025&&t(5,C=(s==null?void 0:s.reduce((l,p)=>{if(p.id){const k=`${Re.ESSAY}:${p.id}`;l[p.id]=(z==null?void 0:z.likes[k])||!1}return l},{}))||{})},[s,c,a,u,g,C,$,H,r,n,z,I,y]}class Oe extends Le{constructor(e){super(),ze(this,e,Je,Ye,Te,{preloadedEssays:8,serverError:9})}}function Qe(o){let e,t;return e=new Oe({props:{preloadedEssays:o[0].essays||[]}}),e.$on("error",o[3]),{c(){oe(e.$$.fragment)},l(r){se(e.$$.fragment,r)},m(r,n){le(e,r,n),t=!0},p(r,n){const i={};n&1&&(i.preloadedEssays=r[0].essays||[]),e.$set(i)},i(r){t||(P(e.$$.fragment,r),t=!0)},o(r){j(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function Ze(o){let e,t,r;function n(c,a){return c[2]>=Me?et:xe}let i=n(o),s=i(o);return{c(){e=m("div"),t=m("p"),r=F(`There was an error loading the essays. 
          `),s.c(),this.h()},l(c){e=_(c,"DIV",{class:!0});var a=L(e);t=_(a,"P",{});var u=L(t);r=B(u,`There was an error loading the essays. 
          `),s.l(u),u.forEach(f),a.forEach(f),this.h()},h(){h(e,"class","error-message svelte-c611qv")},m(c,a){V(c,e,a),d(e,t),d(t,r),s.m(t,null)},p(c,a){i!==(i=n(c))&&(s.d(1),s=i(c),s&&(s.c(),s.m(t,null)))},i:K,o:K,d(c){c&&f(e),s.d()}}}function xe(o){let e;return{c(){e=F("Retrying...")},l(t){e=B(t,"Retrying...")},m(t,r){V(t,e,r)},d(t){t&&f(e)}}}function et(o){let e;return{c(){e=F("Please try refreshing the page.")},l(t){e=B(t,"Please try refreshing the page.")},m(t,r){V(t,e,r)},d(t){t&&f(e)}}}function tt(o){let e,t,r,n,i,s,c,a,u,g,S='Thoughts about <span class="purple">Software.</span>',z,C,q=`<p>How do our natural behaviors and cognitive patterns uncover opportunities
      to rethink software design and create tools that <span class="small-font svelte-c611qv">quietly</span> complement our lives?</p>`,$,H,I,y,l;const p=[Ze,Qe],k=[];function w(v,E){return v[1]?0:1}return I=w(o),y=k[I]=p[I](o),{c(){e=m("meta"),t=m("link"),r=m("meta"),n=m("meta"),i=m("meta"),s=m("meta"),c=m("meta"),a=N(),u=m("main"),g=m("h2"),g.innerHTML=S,z=N(),C=m("div"),C.innerHTML=q,$=N(),H=m("div"),y.c(),this.h()},l(v){const E=Ae("svelte-23ab49",document.head);e=_(E,"META",{name:!0,content:!0}),t=_(E,"LINK",{rel:!0,href:!0}),r=_(E,"META",{property:!0,content:!0}),n=_(E,"META",{property:!0,content:!0}),i=_(E,"META",{property:!0,content:!0}),s=_(E,"META",{property:!0,content:!0}),c=_(E,"META",{property:!0,content:!0}),E.forEach(f),a=R(v),u=_(v,"MAIN",{class:!0});var A=L(u);g=_(A,"H2",{class:!0,"data-svelte-h":!0}),O(g)!=="svelte-1l1gur7"&&(g.innerHTML=S),z=R(A),C=_(A,"DIV",{class:!0,"data-svelte-h":!0}),O(C)!=="svelte-1dyp2ll"&&(C.innerHTML=q),$=R(A),H=_(A,"DIV",{class:!0});var U=L(H);y.l(U),U.forEach(f),A.forEach(f),this.h()},h(){document.title="Writing | Wendy Ham's Weekend Projects",h(e,"name","description"),h(e,"content","Thoughts about creating software that quietly complements our lives."),h(t,"rel","canonical"),h(t,"href","https://xnham.com/writing"),h(r,"property","og:type"),h(r,"content","website"),h(n,"property","og:url"),h(n,"content","https://xnham.com/writing"),h(i,"property","og:title"),h(i,"content","Writing | Wendy Ham's Weekend Projects"),h(s,"property","og:description"),h(s,"content","Thoughts about creating software that quietly complements our lives."),h(c,"property","og:image"),h(c,"content","https://xnham.com/images/og-image.png"),h(g,"class","small-bottom-margin"),h(C,"class","writing-intro svelte-c611qv"),h(H,"class","essays-container svelte-c611qv"),h(u,"class","container")},m(v,E){d(document.head,e),d(document.head,t),d(document.head,r),d(document.head,n),d(document.head,i),d(document.head,s),d(document.head,c),V(v,a,E),V(v,u,E),d(u,g),d(u,z),d(u,C),d(u,$),d(u,H),k[I].m(H,null),l=!0},p(v,[E]){let A=I;I=w(v),I===A?k[I].p(v,E):(te(),j(k[A],1,1,()=>{k[A]=null}),re(),y=k[I],y?y.p(v,E):(y=k[I]=p[I](v),y.c()),P(y,1),y.m(H,null))},i(v){l||(P(y),l=!0)},o(v){j(y),l=!1},d(v){v&&(f(a),f(u)),f(e),f(t),f(r),f(n),f(i),f(s),f(c),k[I].d()}}}const Me=2;function rt(o,e,t){let{data:r}=e,n=!1,i=0;function s(c){console.error("Error in Essays component:",c.detail),t(1,n=!0),i<Me&&(t(2,i++,i),setTimeout(()=>{console.log(`Retry attempt ${i} for Essays component`),t(1,n=!1)},1e3))}return Ie(()=>{Pe.set({title:"Writing | Wendy Ham's Weekend Projects",description:"Thoughts about creating software that quietly complements our lives.",canonicalUrl:"https://xnham.com/writing",type:"website",url:typeof window<"u"?window.location.href:"https://xnham.com/writing"})}),o.$$set=c=>{"data"in c&&t(0,r=c.data)},[r,n,i,s]}class ft extends Le{constructor(e){super(),ze(this,e,rt,tt,Te,{data:0})}}export{ft as component};
