import{s as Be,a as Qe,o as Re,k as Xe,r as Ze,n as de}from"../chunks/scheduler.55fc80cd.js";import{S as Je,i as Ye,g as w,s as j,e as ye,h as k,j as C,f as b,c as z,k as _,a as W,p as pe,t as F,b as ge,d as S,r as G,m as x,x as ne,u as K,n as ee,z as a,I as Fe,v as Q,A as ve,G as xe,o as ie,w as X,H as et,E as tt}from"../chunks/index.0e88a81e.js";import{e as Le,u as lt,o as ot}from"../chunks/each.893eae5b.js";import{F as ae}from"../chunks/FontAwesomeIcon.0301759a.js";import{supabase as st}from"../chunks/supabase.977684e5.js";import{s as nt,C as he,t as rt,a as He}from"../chunks/projectInteractionService.c7bb7d4a.js";import{I as Me}from"../chunks/InteractionButton.ea47d7cf.js";import{u as it}from"../chunks/metadataStore.a1206dd8.js";function Oe(u,e,t){const l=u.slice();return l[23]=e[t],l}function at(u){let e=[],t=new Map,l,f,o=Le(u[0]);const m=n=>n[23].id;for(let n=0;n<o.length;n+=1){let s=Oe(u,o,n),h=m(s);t.set(h,e[n]=Ae(h,s))}return{c(){for(let n=0;n<e.length;n+=1)e[n].c();l=ye()},l(n){for(let s=0;s<e.length;s+=1)e[s].l(n);l=ye()},m(n,s){for(let h=0;h<e.length;h+=1)e[h]&&e[h].m(n,s);W(n,l,s),f=!0},p(n,s){s&12051&&(o=Le(n[0]),pe(),e=lt(e,s,m,1,n,o,t,l.parentNode,ot,Ae,l,Oe),ge())},i(n){if(!f){for(let s=0;s<o.length;s+=1)S(e[s]);f=!0}},o(n){for(let s=0;s<e.length;s+=1)F(e[s]);f=!1},d(n){n&&b(l);for(let s=0;s<e.length;s+=1)e[s].d(n)}}}function ut(u){let e,t,l;return{c(){e=w("div"),t=x("Error: "),l=x(u[3]),this.h()},l(f){e=k(f,"DIV",{class:!0});var o=C(e);t=ee(o,"Error: "),l=ee(o,u[3]),o.forEach(b),this.h()},h(){_(e,"class","error-state svelte-o9016u")},m(f,o){W(f,e,o),a(e,t),a(e,l)},p(f,o){o&8&&ie(l,f[3])},i:de,o:de,d(f){f&&b(e)}}}function ct(u){let e,t="Loading projects...";return{c(){e=w("div"),e.textContent=t,this.h()},l(l){e=k(l,"DIV",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-1g3sdjv"&&(e.textContent=t),this.h()},h(){_(e,"class","loading-state svelte-o9016u")},m(l,f){W(l,e,f)},p:de,i:de,o:de,d(l){l&&b(e)}}}function ft(u){let e,t;return e=new ae({props:{icon:["fas","tree-city"],size:"sm"}}),{c(){G(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,f){Q(e,l,f),t=!0},i(l){t||(S(e.$$.fragment,l),t=!0)},o(l){F(e.$$.fragment,l),t=!1},d(l){X(e,l)}}}function dt(u){let e,t;return e=new ae({props:{icon:["fas","briefcase"],size:"sm"}}),{c(){G(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,f){Q(e,l,f),t=!0},i(l){t||(S(e.$$.fragment,l),t=!0)},o(l){F(e.$$.fragment,l),t=!1},d(l){X(e,l)}}}function mt(u){let e,t;return e=new ae({props:{icon:["fas","house-chimney-window"],size:"sm"}}),{c(){G(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,f){Q(e,l,f),t=!0},i(l){t||(S(e.$$.fragment,l),t=!0)},o(l){F(e.$$.fragment,l),t=!1},d(l){X(e,l)}}}function _t(u){let e,t;return e=new ae({props:{icon:["fas","person"],size:"sm"}}),{c(){G(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,f){Q(e,l,f),t=!0},i(l){t||(S(e.$$.fragment,l),t=!0)},o(l){F(e.$$.fragment,l),t=!1},d(l){X(e,l)}}}function Ie(u){let e,t,l,f,o,m=u[4][u[23].id].message+"",n,s,h,c="×",i,v,p;l=new ae({props:{icon:["fas","info-circle"]}});function O(){return u[17](u[23])}return{c(){e=w("div"),t=w("div"),G(l.$$.fragment),f=j(),o=w("span"),n=x(m),s=j(),h=w("button"),h.textContent=c,this.h()},l($){e=k($,"DIV",{class:!0,role:!0});var T=C(e);t=k(T,"DIV",{class:!0});var I=C(t);K(l.$$.fragment,I),f=z(I),o=k(I,"SPAN",{class:!0});var P=C(o);n=ee(P,m),P.forEach(b),I.forEach(b),s=z(T),h=k(T,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),ne(h)!=="svelte-1c4qzh6"&&(h.textContent=c),T.forEach(b),this.h()},h(){_(o,"class","svelte-o9016u"),_(t,"class","notification-content svelte-o9016u"),_(h,"class","dismiss-notification svelte-o9016u"),_(h,"aria-label","Dismiss notification"),_(e,"class","inline-notification svelte-o9016u"),_(e,"role","status")},m($,T){W($,e,T),a(e,t),Q(l,t,null),a(t,f),a(t,o),a(o,n),a(e,s),a(e,h),i=!0,v||(p=ve(h,"click",O),v=!0)},p($,T){u=$,(!i||T&17)&&m!==(m=u[4][u[23].id].message+"")&&ie(n,m)},i($){i||(S(l.$$.fragment,$),i=!0)},o($){F(l.$$.fragment,$),i=!1},d($){$&&b(e),X(l),v=!1,p()}}}function Ae(u,e){let t,l,f,o,m,n,s,h=e[23].beneficiary+"",c,i,v,p,O=e[23].value+"",$,T,I,P,L=e[23].title+"",q,R,A,H,Z=e[23].longDescription+"",U,r,g,d,D,y,te,M,J,le,B,me="Comment",Ee,ue,_e=qe(e[23].likes,e[23].follows)+"",be,Ce,we,Y,Te,Pe;const je=[_t,mt,dt,ft],re=[];function ze(N,E){return N[23].beneficiary==="personal"?0:N[23].beneficiary==="household"?1:N[23].beneficiary==="work/business"?2:N[23].beneficiary==="community"?3:-1}~(m=ze(e))&&(n=re[m]=je[m](e));function We(){return e[14](e[23])}d=new Me({props:{type:"like",active:e[9][e[23].id],count:void 0,iconSize:"sm",loading:!e[1].initialized}}),d.$on("click",We);function Ge(){return e[15](e[23])}y=new Me({props:{type:"follow",active:e[8][e[23].id],count:void 0,iconSize:"sm",loading:!e[1].initialized}}),y.$on("click",Ge),J=new ae({props:{icon:["far","comment"]}});function Ke(){return e[16](e[23])}let V=e[4][e[23].id]&&Ie(e);return{key:u,first:null,c(){t=w("div"),l=w("div"),f=w("div"),o=w("span"),n&&n.c(),s=j(),c=x(h),i=j(),v=w("span"),p=x("↑ "),$=x(O),I=j(),P=w("h3"),q=x(L),R=j(),A=w("div"),H=new et(!1),U=j(),r=w("div"),g=w("div"),G(d.$$.fragment),D=j(),G(y.$$.fragment),te=j(),M=w("button"),G(J.$$.fragment),le=j(),B=w("span"),B.textContent=me,Ee=j(),ue=w("div"),be=x(_e),Ce=j(),V&&V.c(),we=j(),this.h()},l(N){t=k(N,"DIV",{class:!0});var E=C(t);l=k(E,"DIV",{class:!0});var ce=C(l);f=k(ce,"DIV",{class:!0});var oe=C(f);o=k(oe,"SPAN",{class:!0});var se=C(o);n&&n.l(se),s=z(se),c=ee(se,h),se.forEach(b),i=z(oe),v=k(oe,"SPAN",{class:!0});var De=C(v);p=ee(De,"↑ "),$=ee(De,O),De.forEach(b),oe.forEach(b),ce.forEach(b),I=z(E),P=k(E,"H3",{class:!0});var Se=C(P);q=ee(Se,L),Se.forEach(b),R=z(E),A=k(E,"DIV",{class:!0});var Ve=C(A);H=tt(Ve,!1),Ve.forEach(b),U=z(E),r=k(E,"DIV",{class:!0});var ke=C(r);g=k(ke,"DIV",{class:!0});var fe=C(g);K(d.$$.fragment,fe),D=z(fe),K(y.$$.fragment,fe),te=z(fe),M=k(fe,"BUTTON",{class:!0,"aria-label":!0});var $e=C(M);K(J.$$.fragment,$e),le=z($e),B=k($e,"SPAN",{"data-svelte-h":!0}),ne(B)!=="svelte-1pkkat1"&&(B.textContent=me),$e.forEach(b),fe.forEach(b),Ee=z(ke),ue=k(ke,"DIV",{class:!0});var Ne=C(ue);be=ee(Ne,_e),Ne.forEach(b),ke.forEach(b),Ce=z(E),V&&V.l(E),we=z(E),E.forEach(b),this.h()},h(){_(o,"class","beneficiary-side svelte-o9016u"),_(v,"class",T="value-side "+e[23].value+" svelte-o9016u"),_(f,"class","dual-pill-label svelte-o9016u"),_(l,"class","future-project-card-header svelte-o9016u"),_(P,"class","future-project-card-title svelte-o9016u"),H.a=null,_(A,"class","future-project-card-details svelte-o9016u"),_(M,"class","future-project-comment-button svelte-o9016u"),_(M,"aria-label","Comment on this project"),_(g,"class","future-project-buttons svelte-o9016u"),_(ue,"class","future-project-counters svelte-o9016u"),_(r,"class","future-project-card-actions svelte-o9016u"),_(t,"class","future-project-card svelte-o9016u"),this.first=t},m(N,E){W(N,t,E),a(t,l),a(l,f),a(f,o),~m&&re[m].m(o,null),a(o,s),a(o,c),a(f,i),a(f,v),a(v,p),a(v,$),a(t,I),a(t,P),a(P,q),a(t,R),a(t,A),H.m(Z,A),a(t,U),a(t,r),a(r,g),Q(d,g,null),a(g,D),Q(y,g,null),a(g,te),a(g,M),Q(J,M,null),a(M,le),a(M,B),a(r,Ee),a(r,ue),a(ue,be),a(t,Ce),V&&V.m(t,null),a(t,we),Y=!0,Te||(Pe=ve(M,"click",Ke),Te=!0)},p(N,E){e=N;let ce=m;m=ze(e),m!==ce&&(n&&(pe(),F(re[ce],1,1,()=>{re[ce]=null}),ge()),~m?(n=re[m],n||(n=re[m]=je[m](e),n.c()),S(n,1),n.m(o,s)):n=null),(!Y||E&1)&&h!==(h=e[23].beneficiary+"")&&ie(c,h),(!Y||E&1)&&O!==(O=e[23].value+"")&&ie($,O),(!Y||E&1&&T!==(T="value-side "+e[23].value+" svelte-o9016u"))&&_(v,"class",T),(!Y||E&1)&&L!==(L=e[23].title+"")&&ie(q,L),(!Y||E&1)&&Z!==(Z=e[23].longDescription+"")&&H.p(Z);const oe={};E&513&&(oe.active=e[9][e[23].id]),E&2&&(oe.loading=!e[1].initialized),d.$set(oe);const se={};E&257&&(se.active=e[8][e[23].id]),E&2&&(se.loading=!e[1].initialized),y.$set(se),(!Y||E&1)&&_e!==(_e=qe(e[23].likes,e[23].follows)+"")&&ie(be,_e),e[4][e[23].id]?V?(V.p(e,E),E&17&&S(V,1)):(V=Ie(e),V.c(),S(V,1),V.m(t,we)):V&&(pe(),F(V,1,1,()=>{V=null}),ge())},i(N){Y||(S(n),S(d.$$.fragment,N),S(y.$$.fragment,N),S(J.$$.fragment,N),S(V),Y=!0)},o(N){F(n),F(d.$$.fragment,N),F(y.$$.fragment,N),F(J.$$.fragment,N),F(V),Y=!1},d(N){N&&b(t),~m&&re[m].d(),X(d),X(y),X(J),V&&V.d(),Te=!1,Pe()}}}function Ue(u){let e,t,l,f="×",o,m,n,s="Get updates about your favorite projects",h,c,i,v,p,O,$,T,I,P,L=u[7]?"Subscribing...":"Subscribe to updates",q,R,A,H,Z="Low volume. Unsubscribe anytime.",U,r,g;return T=new ae({props:{icon:["far","bell"]}}),{c(){e=w("div"),t=w("div"),l=w("button"),l.textContent=f,o=j(),m=w("div"),n=w("h3"),n.textContent=s,h=j(),c=w("div"),i=w("div"),v=w("form"),p=w("input"),O=j(),$=w("button"),G(T.$$.fragment),I=j(),P=w("span"),q=x(L),A=j(),H=w("p"),H.textContent=Z,this.h()},l(d){e=k(d,"DIV",{class:!0});var D=C(e);t=k(D,"DIV",{class:!0});var y=C(t);l=k(y,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),ne(l)!=="svelte-1cq1p10"&&(l.textContent=f),o=z(y),m=k(y,"DIV",{class:!0});var te=C(m);n=k(te,"H3",{class:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1avk8gt"&&(n.textContent=s),h=z(te),c=k(te,"DIV",{class:!0});var M=C(c);i=k(M,"DIV",{class:!0});var J=C(i);v=k(J,"FORM",{});var le=C(v);p=k(le,"INPUT",{type:!0,placeholder:!0,class:!0}),O=z(le),$=k(le,"BUTTON",{type:!0,class:!0});var B=C($);K(T.$$.fragment,B),I=z(B),P=k(B,"SPAN",{class:!0});var me=C(P);q=ee(me,L),me.forEach(b),B.forEach(b),le.forEach(b),J.forEach(b),A=z(M),H=k(M,"P",{class:!0,"data-svelte-h":!0}),ne(H)!=="svelte-zvzd9g"&&(H.textContent=Z),M.forEach(b),te.forEach(b),y.forEach(b),D.forEach(b),this.h()},h(){_(l,"class","future-project-close-modal svelte-o9016u"),_(l,"aria-label","Close modal"),_(n,"class","future-project-modal-title svelte-o9016u"),_(p,"type","email"),_(p,"placeholder","Your email address"),p.required=!0,_(p,"class","follow-email-input svelte-o9016u"),_(P,"class","button-icon-text svelte-o9016u"),_($,"type","submit"),_($,"class","modal-action-btn svelte-o9016u"),$.disabled=R=u[7]||!u[6],_(i,"class","future-project-form-group svelte-o9016u"),_(H,"class","future-project-privacy-note svelte-o9016u"),_(c,"class","future-project-form-and-button svelte-o9016u"),_(m,"class","future-project-modal-inner-content svelte-o9016u"),_(t,"class","future-project-modal-content svelte-o9016u"),_(e,"class","future-project-modal svelte-o9016u")},m(d,D){W(d,e,D),a(e,t),a(t,l),a(t,o),a(t,m),a(m,n),a(m,h),a(m,c),a(c,i),a(i,v),a(v,p),Fe(p,u[6]),a(v,O),a(v,$),Q(T,$,null),a($,I),a($,P),a(P,q),a(c,A),a(c,H),U=!0,r||(g=[ve(l,"click",u[18]),ve(p,"input",u[19]),Xe(pt.call(null,p)),ve(v,"submit",xe(u[12]))],r=!0)},p(d,D){D&64&&p.value!==d[6]&&Fe(p,d[6]),(!U||D&128)&&L!==(L=d[7]?"Subscribing...":"Subscribe to updates")&&ie(q,L),(!U||D&192&&R!==(R=d[7]||!d[6]))&&($.disabled=R)},i(d){U||(S(T.$$.fragment,d),U=!0)},o(d){F(T.$$.fragment,d),U=!1},d(d){d&&b(e),X(T),r=!1,Ze(g)}}}function ht(u){let e,t,l,f,o,m;const n=[ct,ut,at],s=[];function h(i,v){return i[2]?0:i[3]?1:2}t=h(u),l=s[t]=n[t](u);let c=u[5]&&Ue(u);return{c(){e=w("div"),l.c(),f=j(),c&&c.c(),o=ye(),this.h()},l(i){e=k(i,"DIV",{class:!0,id:!0});var v=C(e);l.l(v),v.forEach(b),f=z(i),c&&c.l(i),o=ye(),this.h()},h(){_(e,"class","future-projects svelte-o9016u"),_(e,"id","projectList")},m(i,v){W(i,e,v),s[t].m(e,null),W(i,f,v),c&&c.m(i,v),W(i,o,v),m=!0},p(i,[v]){let p=t;t=h(i),t===p?s[t].p(i,v):(pe(),F(s[p],1,1,()=>{s[p]=null}),ge(),l=s[t],l?l.p(i,v):(l=s[t]=n[t](i),l.c()),S(l,1),l.m(e,null)),i[5]?c?(c.p(i,v),v&32&&S(c,1)):(c=Ue(i),c.c(),S(c,1),c.m(o.parentNode,o)):c&&(pe(),F(c,1,1,()=>{c=null}),ge())},i(i){m||(S(l),S(c),m=!0)},o(i){F(l),F(c),m=!1},d(i){i&&(b(e),b(f),b(o)),s[t].d(),c&&c.d(i)}}}function qe(u,e){return u===0&&e===0?"":u>0&&e===0?`${u} ${u===1?"like":"likes"}`:u===0&&e>0?`${e} ${e===1?"follower":"followers"}`:`${u} ${u===1?"like":"likes"} & ${e} ${e===1?"follower":"followers"}`}function vt(u){console.log("Comment clicked for project:",u)}function pt(u){u.focus()}function gt(u,e,t){let l,f,o=[],m=!0,n=null,s={},h=!1,c=null,i="",v=!1,p={likes:{},follows:{},userEmail:void 0,initialized:!1};Qe(()=>{p.initialized&&console.log("Interaction state initialized:",{likes:p.likes,follows:p.follows,likedStatus:l,followStatus:f})}),Re(()=>{async function r(){try{console.log("Starting to fetch projects from Supabase...");const{data:d,error:D}=await st.from("projects").select("*").eq("status","future").eq("show",!0).order("order",{ascending:!0});if(console.log("Supabase query result:",{data:d,fetchError:D}),D)throw D;t(0,o=d||[]),console.log("Projects loaded:",o.length),console.log("Projects loaded:",o),setTimeout(()=>{console.log("Current interaction state:",{initialized:p.initialized,likes:p.likes,follows:p.follows})},1e3),t(2,m=!1)}catch(d){console.error("Error loading projects:",d),t(3,n=d instanceof Error?d.message:"Failed to load projects"),t(2,m=!1)}}r();const g=nt(d=>{console.log("Interaction state updated:",d),t(1,p={...d,initialized:!0}),console.log("Derived like status:",l),console.log("Derived follow status:",f)});return()=>{g()}});function O(r){const g=l[r];rt(he.PROJECT,r),t(0,o=o.map(d=>d.id===r?{...d,likes:d.likes+(g?-1:1)}:d))}function $(r){const g=o.find(d=>d.id===r);return g?g.title:"this project"}async function T(r){try{const g=f[r],d=!g;t(0,o=o.map(y=>y.id===r?{...y,follows:y.follows+(g?-1:1)}:y)),P(r,d?`You are now following ${$(r)}.`:`You have unfollowed ${$(r)}.`);const D=await He(he.PROJECT,r);D.needsEmail?(L(r),t(5,h=!0),c=r,t(0,o=o.map(y=>y.id===r?{...y,follows:y.follows-1}:y))):D.success||(t(0,o=o.map(y=>y.id===r?{...y,follows:y.follows+(d?-1:1)}:y)),P(r,"Sorry, we couldn't update your follow status. Please try again."))}catch(g){console.error("Failed to toggle follow:",g),P(r,"An error occurred. Please try again.")}}async function I(){if(c)try{if(t(7,v=!0),!i||!i.includes("@"))return;if((await He(he.PROJECT,c,i)).success){const g=$(c),d=c;t(0,o=o.map(D=>D.id===d?{...D,follows:D.follows+1}:D)),t(5,h=!1),c=null,setTimeout(()=>{P(d,`You are now following ${g}.`)},100)}}catch(r){console.error("Failed to submit email:",r)}finally{t(7,v=!1)}}function P(r,g){var d;(d=s[r])!=null&&d.timer&&clearTimeout(s[r].timer),t(4,s[r]={projectId:r,message:g,timer:setTimeout(()=>{L(r)},2500)},s),t(4,s={...s})}function L(r){s[r]&&(s[r].timer&&clearTimeout(s[r].timer),delete s[r],t(4,s={...s}))}const q=r=>O(r.id),R=r=>T(r.id),A=r=>vt(r.id),H=r=>L(r.id),Z=()=>t(5,h=!1);function U(){i=this.value,t(6,i)}return u.$$.update=()=>{u.$$.dirty&3&&t(9,l=o.reduce((r,g)=>(r[g.id]=(p==null?void 0:p.likes[`${he.PROJECT}:${g.id}`])||!1,r),{})),u.$$.dirty&3&&t(8,f=o.reduce((r,g)=>(r[g.id]=(p==null?void 0:p.follows[`${he.PROJECT}:${g.id}`])||!1,r),{}))},[o,p,m,n,s,h,i,v,f,l,O,T,I,L,q,R,A,H,Z,U]}class bt extends Je{constructor(e){super(),Ye(this,e,gt,ht,Be,{})}}function wt(u){let e,t,l='Tell Me What to Build <span class="purple">Next.</span>',f,o,m='<p class="svelte-1oapx03">Like the projects that resonate with you. Follow the ones you want access to.</p> <p class="svelte-1oapx03">If you&#39;re looking for a project inspiration, how about having a chat with <a href="/sunny" class="svelte-1oapx03">Sunny</a>, my helpful robot? It will help you figure out where to start.</p>',n,s,h;return s=new bt({}),{c(){e=w("div"),t=w("h2"),t.innerHTML=l,f=j(),o=w("div"),o.innerHTML=m,n=j(),G(s.$$.fragment),this.h()},l(c){e=k(c,"DIV",{class:!0});var i=C(e);t=k(i,"H2",{class:!0,"data-svelte-h":!0}),ne(t)!=="svelte-2hzcia"&&(t.innerHTML=l),f=z(i),o=k(i,"DIV",{class:!0,"data-svelte-h":!0}),ne(o)!=="svelte-1s7j13a"&&(o.innerHTML=m),n=z(i),K(s.$$.fragment,i),i.forEach(b),this.h()},h(){_(t,"class","small-bottom-margin"),_(o,"class","future-project-intro svelte-1oapx03"),_(e,"class","container")},m(c,i){W(c,e,i),a(e,t),a(e,f),a(e,o),a(e,n),Q(s,e,null),h=!0},p:de,i(c){h||(S(s.$$.fragment,c),h=!0)},o(c){F(s.$$.fragment,c),h=!1},d(c){c&&b(e),X(s)}}}function kt(u){return Re(()=>{it({title:"Next | Wendy Ham's Weekend Projects",description:"Have a say in what I build next. Like the projects that resonate with you and follow the ones you want access to.",type:"website",canonicalUrl:"https://xnham.com/next"})}),[]}class zt extends Je{constructor(e){super(),Ye(this,e,kt,wt,Be,{})}}export{zt as component};
