import{_ as Ue}from"../chunks/preload-helper.a4192956.js";import{s as Oe,d as je,o as Be,n as $,f as Je}from"../chunks/scheduler.77de885a.js";import{S as ze,i as Re,e as we,s as I,g as v,D as qe,f as c,c as P,h as y,j as W,x as Q,k as d,z as m,a as E,t as te,b as We,d as x,p as He,m as J,r as Ee,n as z,u as Ce,v as Ie,o as q,w as Pe,B as Te,H as Ye,E as Ke,A as Fe}from"../chunks/index.aa830225.js";import{p as Ge}from"../chunks/stores.3c1e7b19.js";import{f as Se}from"../chunks/index.73909c34.js";import{m as Qe}from"../chunks/metadataStore.87073389.js";import{I as Le}from"../chunks/InteractionButton.7e53d470.js";import{s as Xe,i as Ze,a as xe,b as $e,C as et,t as tt,r as st}from"../chunks/essayInteractionService.92363ccf.js";function lt(n){return{c(){this.h()},l(e){this.h()},h(){document.title="Essay Not Found | Wendy Ham's Weekend Projects"},m:$,p:$,d:$}}function nt(n){let e,s,l,o,r,_,t,i,f,u,h,D,T,N,j,A,S,C;document.title=e=n[0].essay.title+" | Wendy Ham's Weekend Projects";let b=n[13]&&De();return{c(){s=I(),l=v("meta"),o=I(),r=v("link"),t=I(),b&&b.c(),i=I(),f=v("meta"),u=I(),h=v("meta"),D=I(),T=v("meta"),j=I(),A=v("meta"),S=I(),C=v("meta"),this.h()},l(a){s=P(a),l=y(a,"META",{name:!0,content:!0}),o=P(a),r=y(a,"LINK",{rel:!0,href:!0}),t=P(a),b&&b.l(a),i=P(a),f=y(a,"META",{property:!0,content:!0}),u=P(a),h=y(a,"META",{property:!0,content:!0}),D=P(a),T=y(a,"META",{property:!0,content:!0}),j=P(a),A=y(a,"META",{property:!0,content:!0}),S=P(a),C=y(a,"META",{property:!0,content:!0}),this.h()},h(){d(l,"name","description"),d(l,"content",n[2]),d(r,"rel","canonical"),d(r,"href",_=`https://xnham.com/writing/${n[3].params.slug}`),d(f,"property","og:type"),d(f,"content","article"),d(h,"property","og:url"),d(h,"content",n[1]),d(T,"property","og:title"),d(T,"content",N=`${n[0].essay.title} | Wendy Ham's Weekend Projects`),d(A,"property","og:description"),d(A,"content",n[2]),d(C,"property","og:image"),d(C,"content","https://xnham.com/images/og-image.png")},m(a,g){E(a,s,g),E(a,l,g),E(a,o,g),E(a,r,g),E(a,t,g),b&&b.m(a,g),E(a,i,g),E(a,f,g),E(a,u,g),E(a,h,g),E(a,D,g),E(a,T,g),E(a,j,g),E(a,A,g),E(a,S,g),E(a,C,g)},p(a,g){g&1&&e!==(e=a[0].essay.title+" | Wendy Ham's Weekend Projects")&&(document.title=e),g&4&&d(l,"content",a[2]),g&8&&_!==(_=`https://xnham.com/writing/${a[3].params.slug}`)&&d(r,"href",_),a[13]?b||(b=De(),b.c(),b.m(i.parentNode,i)):b&&(b.d(1),b=null),g&2&&d(h,"content",a[1]),g&1&&N!==(N=`${a[0].essay.title} | Wendy Ham's Weekend Projects`)&&d(T,"content",N),g&4&&d(A,"content",a[2])},d(a){a&&(c(s),c(l),c(o),c(r),c(t),c(i),c(f),c(u),c(h),c(D),c(T),c(j),c(A),c(S),c(C)),b&&b.d(a)}}}function De(n){let e,s="{JSON.stringify(articleJsonLd)}";return{c(){e=v("script"),e.textContent=s,this.h()},l(l){e=y(l,"SCRIPT",{type:!0,"data-svelte-h":!0}),Q(e)!=="svelte-1yce5l5"&&(e.textContent=s),this.h()},h(){d(e,"type","application/ld+json")},m(l,o){E(l,e,o)},d(l){l&&c(e)}}}function rt(n){let e,s,l,o=Ve(n[0].essay.date)+"",r,_,t,i,f,u,h,D,T,N,j=n[0].essay.title+"",A,S,C,b=n[0].essay.description+"",a,g,H,G,V,B,w,U,p=n[8]===1?"like":"likes",M,O,Y,ne,me,se=n[9]===1?"share":"shares",re,he,X,oe,_e,le=n[10]===1?"view":"views",ie,R;i=new Le({props:{type:"like",active:n[4],count:void 0}}),i.$on("click",n[18]),h=new Le({props:{type:"share",active:!1,count:void 0}}),h.$on("click",n[19]);let F=n[5]&&Ae(n);function ve(k,L){return k[0].content===null?ct:k[0].content?at:it}let ae=ve(n),K=ae(n);return{c(){e=v("div"),s=v("div"),l=v("p"),r=J(o),_=I(),t=v("div"),Ee(i.$$.fragment),f=I(),u=v("div"),Ee(h.$$.fragment),D=I(),F&&F.c(),T=I(),N=v("h2"),A=J(j),S=I(),C=v("p"),a=J(b),g=I(),H=v("div"),K.c(),G=I(),V=v("div"),B=v("span"),w=J(n[8]),U=I(),M=J(p),O=I(),Y=v("span"),ne=J(n[9]),me=I(),re=J(se),he=I(),X=v("span"),oe=J(n[10]),_e=I(),ie=J(le),this.h()},l(k){e=y(k,"DIV",{class:!0});var L=W(e);s=y(L,"DIV",{class:!0});var Z=W(s);l=y(Z,"P",{class:!0});var ye=W(l);r=z(ye,o),ye.forEach(c),_=P(Z),t=y(Z,"DIV",{class:!0});var ce=W(t);Ce(i.$$.fragment,ce),f=P(ce),u=y(ce,"DIV",{class:!0});var ue=W(u);Ce(h.$$.fragment,ue),D=P(ue),F&&F.l(ue),ue.forEach(c),ce.forEach(c),Z.forEach(c),T=P(L),N=y(L,"H2",{class:!0});var ge=W(N);A=z(ge,j),ge.forEach(c),S=P(L),C=y(L,"P",{class:!0});var ke=W(C);a=z(ke,b),ke.forEach(c),g=P(L),H=y(L,"DIV",{class:!0});var be=W(H);K.l(be),be.forEach(c),L.forEach(c),G=P(k),V=y(k,"DIV",{class:!0});var ee=W(V);B=y(ee,"SPAN",{class:!0});var fe=W(B);w=z(fe,n[8]),U=P(fe),M=z(fe,p),fe.forEach(c),O=P(ee),Y=y(ee,"SPAN",{class:!0});var de=W(Y);ne=z(de,n[9]),me=P(de),re=z(de,se),de.forEach(c),he=P(ee),X=y(ee,"SPAN",{class:!0});var pe=W(X);oe=z(pe,n[10]),_e=P(pe),ie=z(pe,le),pe.forEach(c),ee.forEach(c),this.h()},h(){d(l,"class","essay-date svelte-1lvpdr8"),d(u,"class","share-button-container svelte-1lvpdr8"),d(t,"class","essay-buttons svelte-1lvpdr8"),d(s,"class","essay-header-row svelte-1lvpdr8"),d(N,"class","essay-title svelte-1lvpdr8"),d(C,"class","essay-description svelte-1lvpdr8"),d(H,"class","content svelte-1lvpdr8"),d(e,"class","essay-container svelte-1lvpdr8"),d(B,"class","essay-stat"),d(Y,"class","essay-stat"),d(X,"class","essay-stat"),d(V,"class","essay-stats svelte-1lvpdr8")},m(k,L){E(k,e,L),m(e,s),m(s,l),m(l,r),m(s,_),m(s,t),Ie(i,t,null),m(t,f),m(t,u),Ie(h,u,null),m(u,D),F&&F.m(u,null),m(e,T),m(e,N),m(N,A),m(e,S),m(e,C),m(C,a),m(e,g),m(e,H),K.m(H,null),E(k,G,L),E(k,V,L),m(V,B),m(B,w),m(B,U),m(B,M),m(V,O),m(V,Y),m(Y,ne),m(Y,me),m(Y,re),m(V,he),m(V,X),m(X,oe),m(X,_e),m(X,ie),R=!0},p(k,L){(!R||L&1)&&o!==(o=Ve(k[0].essay.date)+"")&&q(r,o);const Z={};L&16&&(Z.active=k[4]),i.$set(Z),k[5]?F?(F.p(k,L),L&32&&x(F,1)):(F=Ae(k),F.c(),x(F,1),F.m(u,null)):F&&(He(),te(F,1,1,()=>{F=null}),We()),(!R||L&1)&&j!==(j=k[0].essay.title+"")&&q(A,j),(!R||L&1)&&b!==(b=k[0].essay.description+"")&&q(a,b),ae===(ae=ve(k))&&K?K.p(k,L):(K.d(1),K=ae(k),K&&(K.c(),K.m(H,null))),(!R||L&256)&&q(w,k[8]),(!R||L&256)&&p!==(p=k[8]===1?"like":"likes")&&q(M,p),(!R||L&512)&&q(ne,k[9]),(!R||L&512)&&se!==(se=k[9]===1?"share":"shares")&&q(re,se),(!R||L&1024)&&q(oe,k[10]),(!R||L&1024)&&le!==(le=k[10]===1?"view":"views")&&q(ie,le)},i(k){R||(x(i.$$.fragment,k),x(h.$$.fragment,k),x(F),R=!0)},o(k){te(i.$$.fragment,k),te(h.$$.fragment,k),te(F),R=!1},d(k){k&&(c(e),c(G),c(V)),Pe(i),Pe(h),F&&F.d(),K.d()}}}function ot(n){let e,s="Essay not found";return{c(){e=v("div"),e.textContent=s,this.h()},l(l){e=y(l,"DIV",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-976hnr"&&(e.textContent=s),this.h()},h(){d(e,"class","error svelte-1lvpdr8")},m(l,o){E(l,e,o)},p:$,i:$,o:$,d(l){l&&c(e)}}}function Ae(n){let e,s,l,o;return{c(){e=v("div"),s=J(n[5]),this.h()},l(r){e=y(r,"DIV",{class:!0});var _=W(e);s=z(_,n[5]),_.forEach(c),this.h()},h(){d(e,"class","copy-feedback svelte-1lvpdr8")},m(r,_){E(r,e,_),m(e,s),o=!0},p(r,_){(!o||_&32)&&q(s,r[5])},i(r){o||(r&&Je(()=>{o&&(l||(l=Te(e,Se,{duration:150},!0)),l.run(1))}),o=!0)},o(r){r&&(l||(l=Te(e,Se,{duration:150},!1)),l.run(0)),o=!1},d(r){r&&c(e),r&&l&&l.end()}}}function it(n){let e,s="Essay content could not be loaded. Please try again later.",l,o,r,_="View details",t,i,f=JSON.stringify(n[0],null,2)+"",u;return{c(){e=v("p"),e.textContent=s,l=I(),o=v("details"),r=v("summary"),r.textContent=_,t=I(),i=v("pre"),u=J(f),this.h()},l(h){e=y(h,"P",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-1708ro"&&(e.textContent=s),l=P(h),o=y(h,"DETAILS",{});var D=W(o);r=y(D,"SUMMARY",{"data-svelte-h":!0}),Q(r)!=="svelte-1l5nnlp"&&(r.textContent=_),t=P(D),i=y(D,"PRE",{});var T=W(i);u=z(T,f),T.forEach(c),D.forEach(c),this.h()},h(){d(e,"class","loading error svelte-1lvpdr8")},m(h,D){E(h,e,D),E(h,l,D),E(h,o,D),m(o,r),m(o,t),m(o,i),m(i,u)},p(h,D){D&1&&f!==(f=JSON.stringify(h[0],null,2)+"")&&q(u,f)},d(h){h&&(c(e),c(l),c(o))}}}function at(n){let e,s,l=n[0].content+"";return{c(){e=v("div"),s=new Ye(!1),this.h()},l(o){e=y(o,"DIV",{class:!0});var r=W(e);s=Ke(r,!1),r.forEach(c),this.h()},h(){s.a=null,d(e,"class","essay-content svelte-1lvpdr8")},m(o,r){E(o,e,r),s.m(l,e)},p(o,r){r&1&&l!==(l=o[0].content+"")&&s.p(l)},d(o){o&&c(e)}}}function ct(n){let e,s,l=n[6]?"Loading essay content...":"Content not available.",o,r,_,t=!n[6]&&!n[7]&&Me(n),i=n[7]&&Ne(n);return{c(){e=v("div"),s=v("p"),o=J(l),r=I(),t&&t.c(),_=I(),i&&i.c(),this.h()},l(f){e=y(f,"DIV",{class:!0});var u=W(e);s=y(u,"P",{class:!0});var h=W(s);o=z(h,l),h.forEach(c),r=P(u),t&&t.l(u),_=P(u),i&&i.l(u),u.forEach(c),this.h()},h(){d(s,"class","loading svelte-1lvpdr8"),d(e,"class","loading-container svelte-1lvpdr8")},m(f,u){E(f,e,u),m(e,s),m(s,o),m(e,r),t&&t.m(e,null),m(e,_),i&&i.m(e,null)},p(f,u){u&64&&l!==(l=f[6]?"Loading essay content...":"Content not available.")&&q(o,l),!f[6]&&!f[7]?t?t.p(f,u):(t=Me(f),t.c(),t.m(e,_)):t&&(t.d(1),t=null),f[7]?i?i.p(f,u):(i=Ne(f),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(f){f&&c(e),t&&t.d(),i&&i.d()}}}function Me(n){let e,s="Load Content",l,o;return{c(){e=v("button"),e.textContent=s,this.h()},l(r){e=y(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-s6mskc"&&(e.textContent=s),this.h()},h(){d(e,"class","load-button svelte-1lvpdr8")},m(r,_){E(r,e,_),l||(o=Fe(e,"click",n[14]),l=!0)},p:$,d(r){r&&c(e),l=!1,o()}}}function Ne(n){let e,s,l,o,r,_="Try Again",t,i;return{c(){e=v("p"),s=J("Error: "),l=J(n[7]),o=I(),r=v("button"),r.textContent=_,this.h()},l(f){e=y(f,"P",{class:!0});var u=W(e);s=z(u,"Error: "),l=z(u,n[7]),u.forEach(c),o=P(f),r=y(f,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(r)!=="svelte-1viktqy"&&(r.textContent=_),this.h()},h(){d(e,"class","error-message svelte-1lvpdr8"),d(r,"class","load-button svelte-1lvpdr8")},m(f,u){E(f,e,u),m(e,s),m(e,l),E(f,o,u),E(f,r,u),t||(i=Fe(r,"click",n[14]),t=!0)},p(f,u){u&128&&q(l,f[7])},d(f){f&&(c(e),c(o),c(r)),t=!1,i()}}}function ut(n){let e,s,l,o,r=`&lt; 
    <a href="/writing" class="svelte-1lvpdr8"><span class="link-text svelte-1lvpdr8">Back to essays</span></a>`,_,t,i,f="<",u,h,D="Back",T,N,j,A,S,C,b;function a(w,U){return w[0].essay?nt:lt}let g=a(n),H=g(n);const G=[ot,rt],V=[];function B(w,U){return w[0].essay?1:0}return S=B(n),C=V[S]=G[S](n),{c(){H.c(),e=we(),s=I(),l=v("div"),o=v("div"),o.innerHTML=r,_=I(),t=v("a"),i=v("span"),i.textContent=f,u=I(),h=v("span"),h.textContent=D,j=I(),A=v("article"),C.c(),this.h()},l(w){const U=qe("svelte-akv0tl",document.head);H.l(U),e=we(),U.forEach(c),s=P(w),l=y(w,"DIV",{class:!0});var p=W(l);o=y(p,"DIV",{class:!0,"data-svelte-h":!0}),Q(o)!=="svelte-r7biw2"&&(o.innerHTML=r),_=P(p),t=y(p,"A",{href:!0,class:!0,"aria-hidden":!0});var M=W(t);i=y(M,"SPAN",{class:!0,"data-svelte-h":!0}),Q(i)!=="svelte-19se4d7"&&(i.textContent=f),u=P(M),h=y(M,"SPAN",{class:!0,"data-svelte-h":!0}),Q(h)!=="svelte-1v4nvf1"&&(h.textContent=D),M.forEach(c),j=P(p),A=y(p,"ARTICLE",{class:!0});var O=W(A);C.l(O),O.forEach(c),p.forEach(c),this.h()},h(){d(o,"class","back-button svelte-1lvpdr8"),d(i,"class","arrow svelte-1lvpdr8"),d(h,"class","floating-link-text svelte-1lvpdr8"),d(t,"href","/writing"),d(t,"class",T="floating-back-button "+(n[12]?"visible":"hidden")+" "+(n[11]?"":"instant-hide")+" svelte-1lvpdr8"),d(t,"aria-hidden",N=!n[12]),d(A,"class","svelte-1lvpdr8"),d(l,"class","container")},m(w,U){H.m(document.head,null),m(document.head,e),E(w,s,U),E(w,l,U),m(l,o),m(l,_),m(l,t),m(t,i),m(t,u),m(t,h),m(l,j),m(l,A),V[S].m(A,null),b=!0},p(w,[U]){g===(g=a(w))&&H?H.p(w,U):(H.d(1),H=g(w),H&&(H.c(),H.m(e.parentNode,e))),(!b||U&6144&&T!==(T="floating-back-button "+(w[12]?"visible":"hidden")+" "+(w[11]?"":"instant-hide")+" svelte-1lvpdr8"))&&d(t,"class",T),(!b||U&4096&&N!==(N=!w[12]))&&d(t,"aria-hidden",N);let p=S;S=B(w),S===p?V[S].p(w,U):(He(),te(V[p],1,1,()=>{V[p]=null}),We(),C=V[S],C?C.p(w,U):(C=V[S]=G[S](w),C.c()),x(C,1),C.m(A,null))},i(w){b||(x(C),b=!0)},o(w){te(C),b=!1},d(w){w&&(c(s),c(l)),H.d(w),c(e),V[S].d()}}}function Ve(n){const[e,s,l]=n.split("-"),o=["January","February","March","April","May","June","July","August","September","October","November","December"],r=parseInt(s,10)-1,_=o[r],t=l.startsWith("0")?l.substring(1):l;return`${_} ${t}, ${e}`}function ft(n,e,s){let l,o,r,_;je(n,Ge,p=>s(3,_=p));let{data:t}=e,i=!1,f="",u=null,h=!1,D=null,T=0,N=0,j=0,A=!1,S=!1,C=!1,b=!1,a=!1;async function g(){if(!(!t.essay||h)){s(6,h=!0),s(7,D=null);try{console.log(`Loading content for ${t.essay.slug} on the client side`);const{supabase:p}=await Ue(()=>import("../chunks/supabase.977684e5.js"),["../chunks/supabase.977684e5.js","../chunks/_commonjsHelpers.23102255.js","../chunks/preload-helper.a4192956.js"],import.meta.url),{data:M,error:O}=await p.from("essays").select("content").eq("slug",t.essay.slug).single();if(O)throw new Error(`Failed to fetch content: ${O.message}`);if(!M||!M.content)throw new Error("No content available for this essay");console.log(`Content loaded, length: ${M.content.length}`),s(0,t={...t,content:M.content})}catch(p){console.error("Error loading content on client side:",p),s(7,D=p instanceof Error?p.message:"Unknown error occurred")}finally{s(6,h=!1)}}}async function H(){try{console.log("Initializing interactions on single essay page");const p=await Ze();if(console.log("Interactions initialized on single essay with device ID:",p),p||console.error("Failed to initialize interactions on single essay - no device ID returned"),t.content===null&&(console.log("Content is null, loading on client side"),setTimeout(()=>{g()},100)),t.essay&&(Qe.set({title:`${t.essay.title} | Wendy Ham's Weekend Projects`,description:l,canonicalUrl:`https://xnham.com/writing/${_.params.slug}`,type:"article",url:o}),t.essay.id)){const M=xe(t.essay.id);console.log(`Essay ${t.essay.id} already liked:`,M),s(4,i=M);try{await $e(t.essay.id),console.log(`View recorded for essay ${t.essay.id}`)}catch(O){console.error(`Error recording view for essay ${t.essay.id}:`,O)}}}catch(p){console.error("Error during single essay interaction initialization:",p)}}Be(()=>{H();const p=Xe(M=>{if(t.essay&&t.essay.id){const O=`${et.ESSAY}:${t.essay.id}`;s(4,i=!!M.likes[O])}});return window.addEventListener("scroll",G),()=>{p(),window.removeEventListener("scroll",G),u&&clearTimeout(u)}});function G(){typeof window>"u"||a||(a=!0,requestAnimationFrame(()=>{const p=window.scrollY;s(11,C=p>300),C&&!b?s(12,b=!0):!C&&b&&s(12,b=!1),a=!1}))}async function V(){if(console.log("Single essay handleLike called"),!t.essay||!t.essay.id){console.error("Cannot like: Missing essay ID");return}try{console.log(`Toggling like for essay ID: ${t.essay.id}`);const p=!i;s(8,T=Math.max(0,T+(p?1:-1))),A=!0,s(4,i=p),s(8,T),s(0,t),s(17,S);const O=await tt(t.essay.id);console.log(`Toggle like result: ${O}`)}catch(p){console.error("Error toggling like:",p),s(8,T=Math.max(0,T+(i?-1:1))),s(4,i=!i),A=!1}}async function B(){try{if(!t.essay||!t.essay.id){console.error("Cannot share: Missing essay ID");return}console.log(`Sharing essay ID: ${t.essay.id}`);const p=`${window.location.origin}/writing/${t.essay.slug}`;s(9,N+=1),A=!0,s(9,N),s(0,t),s(17,S),await navigator.clipboard.writeText(p),s(5,f="URL copied to clipboard!"),u&&clearTimeout(u),u=setTimeout(()=>{s(5,f="")},3e3);const M=await st(t.essay.id);console.log(`Share recorded: ${M}`)}catch(p){console.error("Error sharing essay:",p),s(5,f="Failed to copy URL"),u=setTimeout(()=>{s(5,f="")},3e3),s(9,N=Math.max(0,N-1)),A=!1}}const w=p=>{console.log("Like button clicked in single essay view"),V()},U=p=>{console.log("Share button clicked in single essay view"),B()};return n.$$set=p=>{"data"in p&&s(0,t=p.data)},n.$$.update=()=>{var p,M,O,Y;n.$$.dirty&131073&&t!=null&&t.essay&&!S&&(s(8,T=t.essay.like_count||0),s(9,N=t.essay.share_count||0),s(10,j=(t.essay.view_count||0)+1),A=!0,s(17,S=!0)),n.$$.dirty&1&&s(2,l=(p=t==null?void 0:t.essay)!=null&&p.description&&((M=t==null?void 0:t.essay)!=null&&M.excerpt)?`${t.essay.description} ${t.essay.excerpt}`:((O=t==null?void 0:t.essay)==null?void 0:O.description)||((Y=t==null?void 0:t.essay)==null?void 0:Y.excerpt)||""),n.$$.dirty&8&&s(1,o=typeof window<"u"?window.location.href:`https://xnham.com/writing/${_.params.slug}`),n.$$.dirty&7&&s(13,r=t!=null&&t.essay?{"@context":"https://schema.org","@type":"Article",headline:t.essay.title,description:l,datePublished:t.essay.date,author:{"@type":"Person",name:"Wendy Ham",url:"https://xnham.com"},publisher:{"@type":"Person",name:"Wendy Ham",url:"https://xnham.com"},mainEntityOfPage:{"@type":"WebPage","@id":o}}:null)},[t,o,l,_,i,f,h,D,T,N,j,C,b,r,g,V,B,S,w,U]}class kt extends ze{constructor(e){super(),Re(this,e,ft,ut,Oe,{data:0})}}export{kt as component};
